<template>
  <view class="position-test-page">
    <!-- é¡µé¢å¤´éƒ¨ -->
    <view class="page-header">
      <text class="page-title">ğŸ“ ä½ç½®æµ‹è¯•</text>
      <text class="page-subtitle">å¼€å‘å·¥å…· - å®šä½åŠŸèƒ½è°ƒè¯•</text>
    </view>

    <!-- åŠŸèƒ½çŠ¶æ€ -->
    <view class="status-card">
      <view class="status-header">
        <text class="status-title">ğŸš§ åŠŸèƒ½çŠ¶æ€</text>
        <view class="status-badge disabled">
          <text class="badge-text">æœªå¯ç”¨</text>
        </view>
      </view>
      
      <text class="status-description">
        ä½ç½®æµ‹è¯•åŠŸèƒ½å½“å‰å¤„äºå¼€å‘é˜¶æ®µï¼Œæš‚æœªå¯ç”¨ã€‚æ­¤åŠŸèƒ½å°†ç”¨äºæµ‹è¯•åº”ç”¨çš„å®šä½æœåŠ¡ã€åœ°ç†ä½ç½®è·å–å’Œç›¸å…³APIè°ƒç”¨ã€‚
      </text>
      
      <view class="status-features">
        <text class="features-title">è®¡åˆ’åŠŸèƒ½:</text>
        <view class="feature-list">
          <view class="feature-item">
            <text class="feature-icon">ğŸŒ</text>
            <text class="feature-text">GPSå®šä½æµ‹è¯•</text>
          </view>
          <view class="feature-item">
            <text class="feature-icon">ğŸ“¡</text>
            <text class="feature-text">ç½‘ç»œå®šä½æµ‹è¯•</text>
          </view>
          <view class="feature-item">
            <text class="feature-icon">ğŸ—ºï¸</text>
            <text class="feature-text">åœ°å›¾æœåŠ¡é›†æˆ</text>
          </view>
          <view class="feature-item">
            <text class="feature-icon">ğŸ“Š</text>
            <text class="feature-text">å®šä½ç²¾åº¦åˆ†æ</text>
          </view>
        </view>
      </view>
    </view>

    <!-- æ¨¡æ‹Ÿç•Œé¢é¢„è§ˆ -->
    <view class="preview-section">
      <text class="section-title">ğŸ¨ ç•Œé¢é¢„è§ˆ</text>
      <text class="section-subtitle">åŠŸèƒ½å¯ç”¨åçš„ç•Œé¢æ•ˆæœ</text>
      
      <view class="preview-container">
        <!-- å®šä½æ§åˆ¶é¢æ¿ -->
        <view class="control-panel disabled">
          <view class="panel-header">
            <text class="panel-title">å®šä½æ§åˆ¶</text>
            <view class="location-status">
              <view class="status-dot offline"></view>
              <text class="status-text">ç¦»çº¿</text>
            </view>
          </view>
          
          <view class="control-buttons">
            <button class="control-btn" disabled>
              ğŸ“ è·å–å½“å‰ä½ç½®
            </button>
            <button class="control-btn" disabled>
              ğŸ”„ åˆ·æ–°ä½ç½®
            </button>
            <button class="control-btn" disabled>
              âš™ï¸ å®šä½è®¾ç½®
            </button>
          </view>
        </view>
        
        <!-- ä½ç½®ä¿¡æ¯æ˜¾ç¤º -->
        <view class="location-info disabled">
          <text class="info-title">ä½ç½®ä¿¡æ¯</text>
          
          <view class="info-grid">
            <view class="info-item">
              <text class="info-label">ç»åº¦</text>
              <text class="info-value">---.------</text>
            </view>
            
            <view class="info-item">
              <text class="info-label">çº¬åº¦</text>
              <text class="info-value">---.------</text>
            </view>
            
            <view class="info-item">
              <text class="info-label">ç²¾åº¦</text>
              <text class="info-value">--- ç±³</text>
            </view>
            
            <view class="info-item">
              <text class="info-label">æµ·æ‹”</text>
              <text class="info-value">--- ç±³</text>
            </view>
            
            <view class="info-item">
              <text class="info-label">é€Ÿåº¦</text>
              <text class="info-value">--- m/s</text>
            </view>
            
            <view class="info-item">
              <text class="info-label">æ–¹å‘</text>
              <text class="info-value">---Â°</text>
            </view>
          </view>
        </view>
        
        <!-- åœ°å€è§£æ -->
        <view class="address-section disabled">
          <text class="address-title">åœ°å€è§£æ</text>
          
          <view class="address-content">
            <view class="address-item">
              <text class="address-label">å›½å®¶:</text>
              <text class="address-value">---</text>
            </view>
            
            <view class="address-item">
              <text class="address-label">çœä»½:</text>
              <text class="address-value">---</text>
            </view>
            
            <view class="address-item">
              <text class="address-label">åŸå¸‚:</text>
              <text class="address-value">---</text>
            </view>
            
            <view class="address-item">
              <text class="address-label">åŒºå¿:</text>
              <text class="address-value">---</text>
            </view>
            
            <view class="address-item">
              <text class="address-label">è¯¦ç»†åœ°å€:</text>
              <text class="address-value">---</text>
            </view>
          </view>
        </view>
        
        <!-- æµ‹è¯•æ—¥å¿— -->
        <view class="test-logs disabled">
          <view class="logs-header">
            <text class="logs-title">æµ‹è¯•æ—¥å¿—</text>
            <button class="clear-logs-btn" disabled>æ¸…ç©º</button>
          </view>
          
          <view class="logs-content">
            <view class="log-item">
              <text class="log-time">[--:--:--]</text>
              <text class="log-message">ç­‰å¾…åŠŸèƒ½å¯ç”¨...</text>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- å¼€å‘è®¡åˆ’ -->
    <view class="roadmap-section">
      <text class="section-title">ğŸ›£ï¸ å¼€å‘è®¡åˆ’</text>
      
      <view class="roadmap-list">
        <view class="roadmap-item">
          <view class="roadmap-status planning">
            <text class="status-icon">ğŸ“‹</text>
          </view>
          
          <view class="roadmap-content">
            <text class="roadmap-title">éœ€æ±‚åˆ†æä¸è®¾è®¡</text>
            <text class="roadmap-description">åˆ†æå®šä½åŠŸèƒ½éœ€æ±‚ï¼Œè®¾è®¡ç”¨æˆ·ç•Œé¢å’Œäº¤äº’æµç¨‹</text>
            <text class="roadmap-progress">è§„åˆ’ä¸­</text>
          </view>
        </view>
        
        <view class="roadmap-item">
          <view class="roadmap-status planning">
            <text class="status-icon">ğŸ”§</text>
          </view>
          
          <view class="roadmap-content">
            <text class="roadmap-title">æ ¸å¿ƒåŠŸèƒ½å¼€å‘</text>
            <text class="roadmap-description">å®ç°GPSå®šä½ã€ç½‘ç»œå®šä½å’Œåœ°å€è§£æåŠŸèƒ½</text>
            <text class="roadmap-progress">å¾…å¼€å‘</text>
          </view>
        </view>
        
        <view class="roadmap-item">
          <view class="roadmap-status planning">
            <text class="status-icon">ğŸ§ª</text>
          </view>
          
          <view class="roadmap-content">
            <text class="roadmap-title">åŠŸèƒ½æµ‹è¯•</text>
            <text class="roadmap-description">åœ¨ä¸åŒè®¾å¤‡å’Œç¯å¢ƒä¸‹æµ‹è¯•å®šä½åŠŸèƒ½çš„å‡†ç¡®æ€§å’Œç¨³å®šæ€§</text>
            <text class="roadmap-progress">å¾…æµ‹è¯•</text>
          </view>
        </view>
        
        <view class="roadmap-item">
          <view class="roadmap-status planning">
            <text class="status-icon">ğŸš€</text>
          </view>
          
          <view class="roadmap-content">
            <text class="roadmap-title">åŠŸèƒ½å‘å¸ƒ</text>
            <text class="roadmap-description">å®Œæˆæµ‹è¯•åæ­£å¼å‘å¸ƒä½ç½®æµ‹è¯•åŠŸèƒ½</text>
            <text class="roadmap-progress">å¾…å‘å¸ƒ</text>
          </view>
        </view>
      </view>
    </view>

    <!-- æ“ä½œæŒ‰é’® -->
    <view class="action-section">
      <button class="notify-btn" @click="requestNotification">
        ğŸ”” åŠŸèƒ½ä¸Šçº¿é€šçŸ¥
      </button>
      
      <button class="feedback-btn" @click="submitFeedback">
        ğŸ’¬ æäº¤å»ºè®®
      </button>
    </view>
  </view>
</template>

<script>
export default {
  data() {
    return {
      notificationRequested: false
    }
  },
  
  onLoad() {
    this.checkNotificationStatus()
  },
  
  methods: {
    /**
     * æ£€æŸ¥é€šçŸ¥çŠ¶æ€
     */
    checkNotificationStatus() {
      try {
        const status = uni.getStorageSync('position_test_notification')
        this.notificationRequested = !!status
      } catch (e) {
        console.error('æ£€æŸ¥é€šçŸ¥çŠ¶æ€å¤±è´¥:', e)
      }
    },
    
    /**
     * è¯·æ±‚åŠŸèƒ½ä¸Šçº¿é€šçŸ¥
     */
    requestNotification() {
      if (this.notificationRequested) {
        uni.showToast({
          title: 'å·²è®¾ç½®é€šçŸ¥æé†’',
          icon: 'success'
        })
        return
      }
      
      uni.showModal({
        title: 'è®¾ç½®é€šçŸ¥',
        content: 'æ˜¯å¦åœ¨ä½ç½®æµ‹è¯•åŠŸèƒ½ä¸Šçº¿æ—¶é€šçŸ¥æ‚¨ï¼Ÿ',
        success: (res) => {
          if (res.confirm) {
            try {
              uni.setStorageSync('position_test_notification', true)
              this.notificationRequested = true
              
              uni.showToast({
                title: 'é€šçŸ¥è®¾ç½®æˆåŠŸ',
                icon: 'success'
              })
            } catch (e) {
              uni.showToast({
                title: 'è®¾ç½®å¤±è´¥',
                icon: 'error'
              })
            }
          }
        }
      })
    },
    
    /**
     * æäº¤åŠŸèƒ½å»ºè®®
     */
    submitFeedback() {
      uni.showModal({
        title: 'åŠŸèƒ½å»ºè®®',
        content: 'æ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æäº¤å¯¹ä½ç½®æµ‹è¯•åŠŸèƒ½çš„å»ºè®®ï¼š\n\n1. åº”ç”¨å†…åé¦ˆ\n2. é‚®ä»¶è”ç³»\n3. ç¤¾åŒºè®¨è®º',
        showCancel: false,
        confirmText: 'çŸ¥é“äº†'
      })
    }
  }
}
</script>

<style scoped>
.position-test-page {
  min-height: 100vh;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  padding: 40rpx 32rpx 200rpx;
}

.page-header {
  text-align: center;
  margin-bottom: 40rpx;
  
  .page-title {
    display: block;
    font-size: 56rpx;
    font-weight: bold;
    color: #ffffff;
    margin-bottom: 16rpx;
  }
  
  .page-subtitle {
    display: block;
    font-size: 28rpx;
    color: rgba(255, 255, 255, 0.8);
  }
}

.status-card {
  background: rgba(255, 255, 255, 0.95);
  border-radius: 16rpx;
  padding: 32rpx 24rpx;
  margin-bottom: 32rpx;
  box-shadow: 0 4rpx 16rpx rgba(0, 0, 0, 0.1);
  
  .status-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16rpx;
    
    .status-title {
      font-size: 32rpx;
      font-weight: bold;
      color: #333333;
    }
    
    .status-badge {
      padding: 8rpx 16rpx;
      border-radius: 16rpx;
      
      &.disabled {
        background: #fff2f0;
        
        .badge-text {
          color: #ff4d4f;
          font-size: 22rpx;
          font-weight: bold;
        }
      }
    }
  }
  
  .status-description {
    display: block;
    font-size: 26rpx;
    color: #666666;
    line-height: 1.6;
    margin-bottom: 24rpx;
  }
  
  .status-features {
    .features-title {
      display: block;
      font-size: 26rpx;
      font-weight: bold;
      color: #333333;
      margin-bottom: 16rpx;
    }
    
    .feature-list {
      .feature-item {
        display: flex;
        align-items: center;
        padding: 12rpx 0;
        
        .feature-icon {
          font-size: 24rpx;
          margin-right: 12rpx;
        }
        
        .feature-text {
          font-size: 24rpx;
          color: #666666;
        }
      }
    }
  }
}

.preview-section {
  margin-bottom: 32rpx;
  
  .section-title {
    display: block;
    font-size: 32rpx;
    font-weight: bold;
    color: #ffffff;
    margin-bottom: 8rpx;
  }
  
  .section-subtitle {
    display: block;
    font-size: 24rpx;
    color: rgba(255, 255, 255, 0.7);
    margin-bottom: 24rpx;
  }
  
  .preview-container {
    .disabled {
      opacity: 0.6;
      pointer-events: none;
    }
  }
}

.control-panel {
  background: rgba(255, 255, 255, 0.95);
  border-radius: 16rpx;
  padding: 24rpx;
  margin-bottom: 16rpx;
  box-shadow: 0 4rpx 16rpx rgba(0, 0, 0, 0.1);
  
  .panel-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20rpx;
    
    .panel-title {
      font-size: 28rpx;
      font-weight: bold;
      color: #333333;
    }
    
    .location-status {
      display: flex;
      align-items: center;
      
      .status-dot {
        width: 16rpx;
        height: 16rpx;
        border-radius: 50%;
        margin-right: 8rpx;
        
        &.offline {
          background: #ff4d4f;
        }
        
        &.online {
          background: #52c41a;
        }
      }
      
      .status-text {
        font-size: 22rpx;
        color: #666666;
      }
    }
  }
  
  .control-buttons {
    display: flex;
    gap: 12rpx;
    
    .control-btn {
      flex: 1;
      height: 64rpx;
      background: #f5f5f5;
      color: #999999;
      border: 2rpx solid #e8e8e8;
      border-radius: 32rpx;
      font-size: 24rpx;
    }
  }
}

.location-info {
  background: rgba(255, 255, 255, 0.95);
  border-radius: 16rpx;
  padding: 24rpx;
  margin-bottom: 16rpx;
  box-shadow: 0 4rpx 16rpx rgba(0, 0, 0, 0.1);
  
  .info-title {
    display: block;
    font-size: 28rpx;
    font-weight: bold;
    color: #333333;
    margin-bottom: 20rpx;
  }
  
  .info-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 16rpx;
    
    .info-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12rpx 16rpx;
      background: #f5f5f5;
      border-radius: 8rpx;
      
      .info-label {
        font-size: 24rpx;
        color: #666666;
      }
      
      .info-value {
        font-size: 24rpx;
        color: #999999;
        font-family: monospace;
      }
    }
  }
}

.address-section {
  background: rgba(255, 255, 255, 0.95);
  border-radius: 16rpx;
  padding: 24rpx;
  margin-bottom: 16rpx;
  box-shadow: 0 4rpx 16rpx rgba(0, 0, 0, 0.1);
  
  .address-title {
    display: block;
    font-size: 28rpx;
    font-weight: bold;
    color: #333333;
    margin-bottom: 20rpx;
  }
  
  .address-content {
    .address-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12rpx 0;
      border-bottom: 1rpx solid #f0f0f0;
      
      &:last-child {
        border-bottom: none;
      }
      
      .address-label {
        font-size: 24rpx;
        color: #666666;
        width: 120rpx;
      }
      
      .address-value {
        flex: 1;
        font-size: 24rpx;
        color: #999999;
        text-align: right;
      }
    }
  }
}

.test-logs {
  background: rgba(255, 255, 255, 0.95);
  border-radius: 16rpx;
  padding: 24rpx;
  margin-bottom: 16rpx;
  box-shadow: 0 4rpx 16rpx rgba(0, 0, 0, 0.1);
  
  .logs-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16rpx;
    
    .logs-title {
      font-size: 28rpx;
      font-weight: bold;
      color: #333333;
    }
    
    .clear-logs-btn {
      padding: 8rpx 16rpx;
      background: #f5f5f5;
      color: #999999;
      border: 1rpx solid #e8e8e8;
      border-radius: 8rpx;
      font-size: 22rpx;
    }
  }
  
  .logs-content {
    background: #f5f5f5;
    border-radius: 8rpx;
    padding: 16rpx;
    min-height: 120rpx;
    
    .log-item {
      display: flex;
      margin-bottom: 8rpx;
      
      &:last-child {
        margin-bottom: 0;
      }
      
      .log-time {
        font-size: 20rpx;
        color: #999999;
        margin-right: 12rpx;
        font-family: monospace;
      }
      
      .log-message {
        font-size: 22rpx;
        color: #666666;
        flex: 1;
      }
    }
  }
}

.roadmap-section {
  margin-bottom: 32rpx;
  
  .section-title {
    display: block;
    font-size: 32rpx;
    font-weight: bold;
    color: #ffffff;
    margin-bottom: 24rpx;
  }
  
  .roadmap-list {
    .roadmap-item {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 16rpx;
      padding: 24rpx;
      margin-bottom: 16rpx;
      display: flex;
      align-items: flex-start;
      box-shadow: 0 4rpx 16rpx rgba(0, 0, 0, 0.1);
      
      .roadmap-status {
        width: 60rpx;
        height: 60rpx;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-right: 20rpx;
        flex-shrink: 0;
        
        &.planning {
          background: #fff7e6;
          
          .status-icon {
            font-size: 24rpx;
          }
        }
      }
      
      .roadmap-content {
        flex: 1;
        
        .roadmap-title {
          display: block;
          font-size: 28rpx;
          font-weight: bold;
          color: #333333;
          margin-bottom: 8rpx;
        }
        
        .roadmap-description {
          display: block;
          font-size: 24rpx;
          color: #666666;
          line-height: 1.5;
          margin-bottom: 12rpx;
        }
        
        .roadmap-progress {
          display: inline-block;
          padding: 4rpx 12rpx;
          background: #fff7e6;
          color: #fa8c16;
          border-radius: 12rpx;
          font-size: 20rpx;
          font-weight: bold;
        }
      }
    }
  }
}

.action-section {
  display: flex;
  gap: 16rpx;
  
  .notify-btn, .feedback-btn {
    flex: 1;
    height: 88rpx;
    border: none;
    border-radius: 44rpx;
    font-size: 28rpx;
    font-weight: bold;
    transition: all 0.3s ease;
    
    &:active {
      transform: scale(0.98);
    }
  }
  
  .notify-btn {
    background: linear-gradient(135deg, #52c41a 0%, #73d13d 100%);
    color: #ffffff;
    box-shadow: 0 8rpx 24rpx rgba(82, 196, 26, 0.4);
  }
  
  .feedback-btn {
    background: rgba(255, 255, 255, 0.9);
    color: #333333;
    box-shadow: 0 4rpx 16rpx rgba(0, 0, 0, 0.1);
  }
}
</style>