# å°ç¨‹åºèœå•è®¾è®¡è§„èŒƒ

## 1. èœå•è®¾è®¡åŸåˆ™

### 1.1 æ ¸å¿ƒè®¾è®¡ç†å¿µ

**ç®€æ´æ€§åŸåˆ™ï¼š**
- èœå•å±‚çº§ä¸è¶…è¿‡3çº§ï¼ˆæ ¹èœå• â†’ ä¸€çº§ â†’ äºŒçº§ï¼‰
- æ¯çº§èœå•é¡¹æ•°é‡æ§åˆ¶åœ¨3-7ä¸ªä¹‹é—´
- é¿å…åŠŸèƒ½é‡å¤å’Œå†—ä½™è·¯å¾„

**ä¸€è‡´æ€§åŸåˆ™ï¼š**
- ç»Ÿä¸€çš„å›¾æ ‡é£æ ¼å’Œè‰²å½©ä½“ç³»
- ä¸€è‡´çš„äº¤äº’è¡Œä¸ºå’ŒåŠ¨ç”»æ•ˆæœ
- æ ‡å‡†åŒ–çš„å‘½åè§„èŒƒ

**å¯è®¿é—®æ€§åŸåˆ™ï¼š**
- æ”¯æŒæ— éšœç¢è®¿é—®
- é€‚é…ä¸åŒå±å¹•å°ºå¯¸
- è€ƒè™‘å•æ‰‹æ“ä½œä¾¿åˆ©æ€§

### 1.2 ç”¨æˆ·ä½“éªŒç›®æ ‡

- **æ•ˆç‡ä¼˜å…ˆ**ï¼šæ ¸å¿ƒåŠŸèƒ½3æ­¥å†…åˆ°è¾¾
- **ç›´è§‚æ˜“æ‡‚**ï¼šå›¾æ ‡+æ–‡å­—åŒé‡æ ‡è¯†
- **ä¸ªæ€§åŒ–**ï¼šæ”¯æŒç”¨æˆ·è‡ªå®šä¹‰å’Œè§’è‰²å·®å¼‚
- **å“åº”è¿…é€Ÿ**ï¼šèœå•åˆ‡æ¢åŠ¨ç”»<300ms

## 2. èœå•å±‚çº§æ¶æ„

### 2.1 å››çº§èœå•ç»“æ„

```
å°ç¨‹åºèœå•æ¶æ„
â”œâ”€â”€ ğŸ  æ ¹èœå• (TabBar)
â”‚   â”œâ”€â”€ ğŸ“± ä¸€çº§èœå• (ä¸»åŠŸèƒ½æ¨¡å—)
â”‚   â”‚   â”œâ”€â”€ ğŸ”§ äºŒçº§èœå• (å­åŠŸèƒ½åˆ†ç±»)
â”‚   â”‚   â””â”€â”€ ğŸ”§ äºŒçº§èœå•
â”‚   â””â”€â”€ ğŸ“± ä¸€çº§èœå•
â””â”€â”€ ğŸ  æ ¹èœå•
```

### 2.2 èœå•ç±»å‹å®šä¹‰

| èœå•çº§åˆ« | å±•ç¤ºå½¢å¼ | åŠŸèƒ½å®šä½ | æ•°é‡é™åˆ¶ | ç¤ºä¾‹ |
|----------|----------|----------|----------|------|
| **æ ¹èœå•** | TabBaråº•éƒ¨å¯¼èˆª | ä¸»è¦åŠŸèƒ½å…¥å£ | 3-5ä¸ª | æ–©è¯ã€å·¥å…·ã€æ—¶å°šã€æˆ‘çš„ |
| **ä¸€çº§èœå•** | é¡µé¢å†…å®¹åŒº | åŠŸèƒ½æ¨¡å—åˆ†ç±» | 4-8ä¸ª | å•è¯å­¦ä¹ ã€å•è¯æŒ‘æˆ˜ã€å•è¯å¤ä¹ ã€ç¤¾åŒº |
| **äºŒçº§èœå•** | åˆ—è¡¨/ç½‘æ ¼å¸ƒå±€ | å…·ä½“åŠŸèƒ½åˆ†ç»„ | 3-6ä¸ª | å•è¯æ‹¼å†™ã€é—ªå¡ç»ƒä¹ ã€é˜…è¯»ç†è§£ |
| **ä¸‰çº§èœå•** | è¯¦æƒ…é¡µ/å¼¹çª— | æœ€ç»ˆæ“ä½œé¡¹ | 2-5ä¸ª | å¼€å§‹ç»ƒä¹ ã€æŸ¥çœ‹è¯¦æƒ…ã€è®¾ç½®éš¾åº¦ |


## 3. è§’è‰²å·®å¼‚åŒ–è®¾è®¡

### 3.1 è§’è‰²èœå•æƒé™çŸ©é˜µ

| åŠŸèƒ½æ¨¡å— | å­¦ç”Ÿ | å®¶é•¿ | æ•™å¸ˆ | æ•™ç ”ç»„é•¿ | æ•™åŠ¡ä¸»ä»» | æ•™å¯¼ä¸»ä»» | ç®¡ç†å‘˜ | æƒé™ä»£ç  |
|----------|------|------|------|----------|----------|----------|--------|----------|
| **ğŸ  ä»ªè¡¨æ¿** | âœ… | âœ… | âœ… | âœ… | âœ… | âœ… | âœ… | `dashboard_access` |
| **ğŸ“š å•è¯å­¦ä¹ ** | âœ… | ğŸ‘ï¸ | âœ… | âœ… | âœ… | âœ… | âœ… | `word_learning_access` |
| **âœï¸ å•è¯æ‹¼å†™** | âœ… | ğŸ‘ï¸ | âœ… | âœ… | âœ… | âœ… | âœ… | `word_spelling_access` |
| **ğŸ“– é˜…è¯»ç†è§£** | âœ… | ğŸ‘ï¸ | âœ… | âœ… | âœ… | âœ… | âœ… | `word_reading_access` |
| **ğŸ§ å¬åŠ›ç»ƒä¹ ** | âœ… | ğŸ‘ï¸ | âœ… | âœ… | âœ… | âœ… | âœ… | `listening_access` |
| **ğŸ¯ å•è¯æŒ‘æˆ˜** | âœ… | ğŸ‘ï¸ | âœ… | âœ… | âœ… | âœ… | âœ… | `competition_access` |
| **ğŸ”„ å•è¯å¤ä¹ ** | âœ… | ğŸ‘ï¸ | âœ… | âœ… | âœ… | âœ… | âœ… | `word_review_access` |
| **ğŸ‘¥ ç¤¾åŒºåŠŸèƒ½** | âœ… | âŒ | âœ… | âœ… | âœ… | âœ… | âœ… | `community_access` |
| **ğŸ“Š å­¦ç”Ÿè¿›åº¦** | ğŸ”’ | âœ… | âœ… | âœ… | âœ… | âœ… | âœ… | `student_progress_view` |
| **ğŸ‘¨â€ğŸ« ç­çº§ç®¡ç†** | âŒ | âŒ | âœ… | âœ… | âœ… | âœ… | âœ… | `class_management` |
| **ğŸ“ˆ æ•°æ®åˆ†æ** | âŒ | ğŸ”’ | ğŸ”’ | âœ… | âœ… | âœ… | âœ… | `analytics_access` |
| **ğŸ‘¤ ç”¨æˆ·ç®¡ç†** | âŒ | âŒ | âŒ | ğŸ”’ | âœ… | âœ… | âœ… | `user_management` |
| **âš™ï¸ ç³»ç»Ÿç®¡ç†** | âŒ | âŒ | âŒ | âŒ | ğŸ”’ | ğŸ”’ | âœ… | `system_management` |
| **ğŸ” æƒé™ç®¡ç†** | âŒ | âŒ | âŒ | âŒ | âŒ | ğŸ”’ | âœ… | `permission_management` |
| **ğŸ’³ è®¢é˜…ç®¡ç†** | ğŸ”’ | âœ… | âŒ | âŒ | âŒ | âŒ | âœ… | `subscription_management` |

**å›¾ä¾‹è¯´æ˜ï¼š**
- âœ… å®Œå…¨è®¿é—®æƒé™
- ğŸ‘ï¸ åªè¯»æŸ¥çœ‹æƒé™
- ğŸ”’ éƒ¨åˆ†åŠŸèƒ½æƒé™
- âŒ æ— è®¿é—®æƒé™

### 3.2 è§’è‰²èœå•å®šåˆ¶

**å­¦ç”Ÿè§’è‰²èœå•ï¼š**
```json
{
  "tabBar": [
    {
      "text": "æ–©è¯",
      "iconPath": "/static/icons/slash-word.png",
      "selectedIconPath": "/static/icons/slash-word-active.png",
      "pagePath": "pages/slash-word/index",
      "permission": "word_learning_access"
    },
    {
      "text": "å·¥å…·",
      "iconPath": "/static/icons/tools.png",
      "selectedIconPath": "/static/icons/tools-active.png",
      "pagePath": "pages/tools/index",
      "permission": "basic_access"
    },
    {
      "text": "æ—¶å°š",
      "iconPath": "/static/icons/fashion.png",
      "selectedIconPath": "/static/icons/fashion-active.png",
      "pagePath": "pages/fashion/index",
      "permission": "community_access"
    },
    {
      "text": "æˆ‘çš„",
      "iconPath": "/static/icons/profile.png",
      "selectedIconPath": "/static/icons/profile-active.png",
      "pagePath": "pages/profile/index",
      "permission": "profile_access"
    }
  ],
  "menuItems": {
    "slash-word": [
      {
        "id": "word_learning",
        "title": "å•è¯å­¦ä¹ ",
        "icon": "ğŸ“š",
        "path": "/pages/learning/words",
        "permission": "word_learning_access",
        "sortOrder": 1,
        "children": [
          {
            "id": "word_spelling",
            "title": "å•è¯æ‹¼å†™",
            "icon": "âœï¸",
            "path": "/pages/learning/spelling",
            "permission": "word_spelling_access"
          },
          {
            "id": "flashcard_practice",
            "title": "é—ªå¡ç»ƒä¹ ",
            "icon": "ğŸƒ",
            "path": "/pages/learning/flashcard",
            "permission": "word_learning_access"
          }
        ]
      },
      {
        "id": "word_challenge",
        "title": "å•è¯æŒ‘æˆ˜",
        "icon": "ğŸ¯",
        "path": "/pages/challenge/index",
        "permission": "competition_access",
        "sortOrder": 2,
        "badge": "hot"
      },
      {
        "id": "word_review",
        "title": "å•è¯å¤ä¹ ",
        "icon": "ğŸ”„",
        "path": "/pages/review/index",
        "permission": "word_review_access",
        "sortOrder": 3
      },
      {
        "id": "reading_comprehension",
        "title": "é˜…è¯»ç†è§£",
        "icon": "ğŸ“–",
        "path": "/pages/reading/index",
        "permission": "word_reading_access",
        "sortOrder": 4
      },
      {
        "id": "listening_practice",
        "title": "å¬åŠ›ç»ƒä¹ ",
        "icon": "ğŸ§",
        "path": "/pages/listening/index",
        "permission": "listening_access",
        "sortOrder": 5
      }
    ],
    "tools": [
      {
        "id": "dictionary",
        "title": "è¯å…¸æŸ¥è¯¢",
        "icon": "ğŸ“–",
        "path": "/pages/tools/dictionary",
        "permission": "basic_access"
      },
      {
        "id": "translator",
        "title": "ç¿»è¯‘å·¥å…·",
        "icon": "ğŸ”„",
        "path": "/pages/tools/translator",
        "permission": "basic_access"
      }
    ],
    "fashion": [
      {
        "id": "community",
        "title": "å­¦ä¹ ç¤¾åŒº",
        "icon": "ğŸ‘¥",
        "path": "/pages/community/index",
        "permission": "community_access"
      },
      {
        "id": "ranking",
        "title": "æ’è¡Œæ¦œ",
        "icon": "ğŸ†",
        "path": "/pages/ranking/index",
        "permission": "community_access"
      }
    ]
  }
}
```

**æ•™å¸ˆè§’è‰²èœå•ï¼š**
```json
{
  "tabBar": [
    {
      "text": "æ–©è¯",
      "iconPath": "/static/icons/slash-word.png",
      "selectedIconPath": "/static/icons/slash-word-active.png",
      "pagePath": "pages/slash-word/index",
      "permission": "word_learning_access"
    },
    {
      "text": "å·¥å…·",
      "iconPath": "/static/icons/tools.png",
      "selectedIconPath": "/static/icons/tools-active.png",
      "pagePath": "pages/tools/index",
      "permission": "basic_access"
    },
    {
      "text": "æ—¶å°š",
      "iconPath": "/static/icons/fashion.png",
      "selectedIconPath": "/static/icons/fashion-active.png",
      "pagePath": "pages/fashion/index",
      "permission": "community_access"
    },
    {
      "text": "æˆ‘çš„",
      "iconPath": "/static/icons/profile.png",
      "selectedIconPath": "/static/icons/profile-active.png",
      "pagePath": "pages/profile/teacher",
      "permission": "profile_access"
    }
  ],
  "menuItems": {
    "tools": [
      {
        "id": "class_management",
        "title": "ç­çº§ç®¡ç†",
        "icon": "ğŸ‘¥",
        "path": "/pages/teacher/classes",
        "permission": "class_management",
        "sortOrder": 1
      },
      {
        "id": "student_progress",
        "title": "å­¦ç”Ÿè¿›åº¦",
        "icon": "ğŸ“Š",
        "path": "/pages/teacher/progress",
        "permission": "student_progress_view",
        "sortOrder": 2
      },
      {
        "id": "teaching_resources",
        "title": "æ•™å­¦èµ„æº",
        "icon": "ğŸ“",
        "path": "/pages/teacher/resources",
        "permission": "teacher_access",
        "sortOrder": 3
      },
      {
        "id": "data_analytics",
        "title": "æ•°æ®åˆ†æ",
        "icon": "ğŸ“ˆ",
        "path": "/pages/teacher/analytics",
        "permission": "analytics_access",
        "sortOrder": 4
      }
    ]
  }
}
```

## 4. ç”¨æˆ·è‡ªå®šä¹‰èœå•

### 4.1 è‡ªå®šä¹‰åŠŸèƒ½è®¾è®¡

**å¯è‡ªå®šä¹‰å…ƒç´ ï¼š**

| è‡ªå®šä¹‰é¡¹ | èŒƒå›´ | é™åˆ¶ | è¯´æ˜ | æƒé™è¦æ±‚ |
|----------|------|------|------|----------|
| **èœå•é¡ºåº** | ä¸€çº§ã€äºŒçº§èœå• | ä¸å¯è·¨çº§è°ƒæ•´ | æ‹–æ‹½æ’åº | `menu_customize` |
| **èœå•æ˜¾ç¤º/éšè—** | äºŒçº§ã€ä¸‰çº§èœå• | å¿…é¡»ä¿ç•™æ ¸å¿ƒåŠŸèƒ½ | å¼€å…³æ§åˆ¶ | `menu_customize` |
| **å¿«æ·å…¥å£** | é¦–é¡µå¿«æ·æŒ‰é’® | æœ€å¤š6ä¸ª | å¸¸ç”¨åŠŸèƒ½å¿«é€Ÿè®¿é—® | `basic_access` |
| **èœå•å›¾æ ‡** | æ‰€æœ‰çº§åˆ« | é¢„è®¾å›¾æ ‡åº“ | ä¸ªæ€§åŒ–å±•ç¤º | `menu_customize` |
| **èœå•åç§°** | äºŒçº§ã€ä¸‰çº§èœå• | å­—ç¬¦é•¿åº¦é™åˆ¶ | ä¸ªäººä¹ æƒ¯å‘½å | `menu_customize` |
| **ä¸»é¢˜è‰²å½©** | å…¨å±€èœå• | é¢„è®¾ä¸»é¢˜æ–¹æ¡ˆ | è§†è§‰ä¸ªæ€§åŒ– | `basic_access` |

**è‡ªå®šä¹‰é™åˆ¶ï¼š**
- æ ¸å¿ƒåŠŸèƒ½ä¸å¯éšè—
- èœå•ç»“æ„ä¸å¯ç ´å
- æƒé™èŒƒå›´å†…è‡ªå®šä¹‰
- éœ€è¦ç›¸åº”æƒé™éªŒè¯

### 4.2 è‡ªå®šä¹‰é…ç½®æ•°æ®ç»“æ„

```typescript
interface UserMenuConfig {
  userId: string
  role: 'student' | 'teacher' | 'parent' | 'admin'
  permissions: string[]           // ç”¨æˆ·æƒé™åˆ—è¡¨
  customization: {
    tabBarOrder: string[]           // TabBar æ’åº
    quickActions: QuickAction[]     // å¿«æ·æ“ä½œ
    hiddenMenus: string[]          // éšè—çš„èœå•é¡¹
    customIcons: Record<string, string>  // è‡ªå®šä¹‰å›¾æ ‡æ˜ å°„
    customNames: Record<string, string>  // è‡ªå®šä¹‰åç§°æ˜ å°„
    theme: {
      primaryColor: string         // ä¸»é¢˜è‰²
      accentColor: string         // å¼ºè°ƒè‰²
      iconStyle: 'outline' | 'filled' // å›¾æ ‡é£æ ¼
      darkMode: boolean           // æ·±è‰²æ¨¡å¼
    }
    layout: {
      gridColumns: number          // ç½‘æ ¼åˆ—æ•°
      showBadges: boolean         // æ˜¾ç¤ºå¾½ç« 
      compactMode: boolean        // ç´§å‡‘æ¨¡å¼
    }
  }
  lastModified: string
  version: string                 // é…ç½®ç‰ˆæœ¬
}

interface QuickAction {
  id: string
  title: string
  icon: string
  path: string
  order: number
  permission: string             // æ‰€éœ€æƒé™
}

// èœå•æƒé™éªŒè¯é…ç½®
interface MenuPermissionConfig {
  menuId: string
  requiredPermissions: string[]
  fallbackMenu?: string          // æ— æƒé™æ—¶çš„æ›¿ä»£èœå•
  customizable: boolean          // æ˜¯å¦å¯è‡ªå®šä¹‰
}
```

### 4.3 èœå•æƒé™éªŒè¯æœºåˆ¶

#### æƒé™éªŒè¯æµç¨‹
```javascript
// èœå•æƒé™éªŒè¯æœåŠ¡
class MenuPermissionService {
  // éªŒè¯ç”¨æˆ·æ˜¯å¦æœ‰èœå•è®¿é—®æƒé™
  static async validateMenuAccess(userId, menuId) {
    const userPermissions = await this.getUserPermissions(userId);
    const menuConfig = await this.getMenuConfig(menuId);
    
    // æ£€æŸ¥å¿…éœ€æƒé™
    const hasRequiredPermissions = menuConfig.requiredPermissions.every(
      permission => userPermissions.includes(permission)
    );
    
    if (!hasRequiredPermissions) {
      // è¿”å›æ›¿ä»£èœå•æˆ–éšè—
      return {
        accessible: false,
        fallbackMenu: menuConfig.fallbackMenu,
        reason: 'insufficient_permissions'
      };
    }
    
    return { accessible: true };
  }
  
  // è¿‡æ»¤ç”¨æˆ·å¯è®¿é—®çš„èœå•
  static async filterAccessibleMenus(userId, menuList) {
    const accessibleMenus = [];
    
    for (const menu of menuList) {
      const validation = await this.validateMenuAccess(userId, menu.id);
      
      if (validation.accessible) {
        // é€’å½’è¿‡æ»¤å­èœå•
        if (menu.children) {
          menu.children = await this.filterAccessibleMenus(userId, menu.children);
        }
        accessibleMenus.push(menu);
      } else if (validation.fallbackMenu) {
        // æ·»åŠ æ›¿ä»£èœå•
        const fallback = await this.getMenuConfig(validation.fallbackMenu);
        accessibleMenus.push(fallback);
      }
    }
    
    return accessibleMenus;
  }
}
```

#### åŠ¨æ€èœå•åŠ è½½
```javascript
// åŠ¨æ€èœå•åŠ è½½å™¨
class DynamicMenuLoader {
  static async loadUserMenu(userId, role) {
    try {
      // 1. è·å–åŸºç¡€èœå•é…ç½®
      const baseMenuConfig = await this.getBaseMenuConfig(role);
      
      // 2. è·å–ç”¨æˆ·è‡ªå®šä¹‰é…ç½®
      const userCustomConfig = await this.getUserCustomConfig(userId);
      
      // 3. æƒé™è¿‡æ»¤
      const filteredMenus = await MenuPermissionService.filterAccessibleMenus(
        userId, 
        baseMenuConfig.menuItems
      );
      
      // 4. åº”ç”¨ç”¨æˆ·è‡ªå®šä¹‰
      const customizedMenus = this.applyUserCustomization(
        filteredMenus, 
        userCustomConfig
      );
      
      // 5. ç¼“å­˜èœå•é…ç½®
      await this.cacheMenuConfig(userId, customizedMenus);
      
      return {
        tabBar: this.buildTabBar(customizedMenus, userCustomConfig),
        menuItems: customizedMenus,
        shortcuts: userCustomConfig.shortcuts || [],
        theme: userCustomConfig.theme || this.getDefaultTheme()
      };
      
    } catch (error) {
      console.error('èœå•åŠ è½½å¤±è´¥:', error);
      // è¿”å›é»˜è®¤èœå•
      return this.getDefaultMenuConfig(role);
    }
  }
  
  // åº”ç”¨ç”¨æˆ·è‡ªå®šä¹‰é…ç½®
  static applyUserCustomization(menuItems, customConfig) {
    return menuItems.map(menu => {
      // åº”ç”¨è‡ªå®šä¹‰åç§°
      if (customConfig.customNames?.[menu.id]) {
        menu.title = customConfig.customNames[menu.id];
      }
      
      // åº”ç”¨è‡ªå®šä¹‰å›¾æ ‡
      if (customConfig.customIcons?.[menu.id]) {
        menu.icon = customConfig.customIcons[menu.id];
      }
      
      // è¿‡æ»¤éšè—çš„èœå•
      if (customConfig.hiddenMenus?.includes(menu.id)) {
        return null;
      }
      
      return menu;
    }).filter(Boolean);
  }
}
```

### 4.4 è‡ªå®šä¹‰ç•Œé¢è®¾è®¡

```vue
<template>
  <view class="menu-customization">
    <!-- é¢„è§ˆåŒºåŸŸ -->
    <view class="preview-section">
      <text class="section-title">é¢„è§ˆæ•ˆæœ</text>
      <view class="mock-tabbar">
        <view 
          v-for="(item, index) in customTabBar" 
          :key="item.id"
          class="tab-item"
          :class="{ active: index === 0 }"
        >
          <image :src="item.icon" class="tab-icon" />
          <text class="tab-text">{{ item.text }}</text>
        </view>
      </view>
    </view>
    
    <!-- ç¼–è¾‘åŒºåŸŸ -->
    <view class="edit-section">
      <text class="section-title">è‡ªå®šä¹‰è®¾ç½®</text>
      
      <!-- èœå•æ’åº -->
      <view class="setting-group">
        <text class="group-title">èœå•æ’åº</text>
        <movable-area class="sortable-area">
          <movable-view 
            v-for="(item, index) in editableMenus"
            :key="item.id"
            class="sortable-item"
            direction="vertical"
            @change="onMenuSort"
          >
            <view class="menu-item">
              <image :src="item.icon" class="item-icon" />
              <text class="item-title">{{ item.title }}</text>
              <view class="drag-handle">â‹®â‹®</view>
            </view>
          </movable-view>
        </movable-area>
      </view>
      
      <!-- ä¸»é¢˜è®¾ç½® -->
      <view class="setting-group">
        <text class="group-title">ä¸»é¢˜è®¾ç½®</text>
        <view class="theme-options">
          <view 
            v-for="color in themeColors"
            :key="color"
            class="color-option"
            :class="{ selected: selectedTheme === color }"
            :style="{ backgroundColor: color }"
            @click="selectTheme(color)"
          />
        </view>
      </view>
    </view>
    
    <!-- æ“ä½œæŒ‰é’® -->
    <view class="action-buttons">
      <button class="btn-reset" @click="resetToDefault">æ¢å¤é»˜è®¤</button>
      <button class="btn-save" @click="saveCustomization">ä¿å­˜è®¾ç½®</button>
    </view>
  </view>
</template>

<script setup lang="ts">
import { ref, computed } from 'vue'
import { useMenuStore } from '@/store/modules/menu'

const menuStore = useMenuStore()

// å¯ç¼–è¾‘èœå•åˆ—è¡¨
const editableMenus = ref([
  { id: 'learning', title: 'å­¦ä¹ ä¸­å¿ƒ', icon: '/static/icons/study.png' },
  { id: 'progress', title: 'å­¦ä¹ è¿›åº¦', icon: '/static/icons/progress.png' },
  { id: 'profile', title: 'ä¸ªäººä¸­å¿ƒ', icon: '/static/icons/profile.png' }
])

// ä¸»é¢˜è‰²é€‰é¡¹
const themeColors = ['#007AFF', '#34C759', '#FF9500', '#FF3B30', '#5856D6']
const selectedTheme = ref('#007AFF')

// è‡ªå®šä¹‰ TabBar
const customTabBar = computed(() => {
  return editableMenus.value.map(item => ({
    ...item,
    text: item.title
  }))
})

// èœå•æ’åº
const onMenuSort = (event: any) => {
  // å¤„ç†æ‹–æ‹½æ’åºé€»è¾‘
}

// é€‰æ‹©ä¸»é¢˜
const selectTheme = (color: string) => {
  selectedTheme.value = color
}

// é‡ç½®ä¸ºé»˜è®¤
const resetToDefault = () => {
  menuStore.resetMenuCustomization()
}

// ä¿å­˜è‡ªå®šä¹‰è®¾ç½®
const saveCustomization = async () => {
  try {
    await menuStore.saveMenuCustomization({
      tabBarOrder: editableMenus.value.map(item => item.id),
      theme: {
        primaryColor: selectedTheme.value,
        iconStyle: 'filled'
      }
    })
    
    uni.showToast({
      title: 'ä¿å­˜æˆåŠŸ',
      icon: 'success'
    })
  } catch (error) {
    uni.showToast({
      title: 'ä¿å­˜å¤±è´¥',
      icon: 'error'
    })
  }
}
</script>
```

## 5. èœå•äº¤äº’è®¾è®¡

### 5.1 äº¤äº’çŠ¶æ€å®šä¹‰

**èœå•é¡¹çŠ¶æ€ï¼š**
- **é»˜è®¤çŠ¶æ€**ï¼šæ­£å¸¸æ˜¾ç¤º
- **æ‚¬åœçŠ¶æ€**ï¼šè½»å¾®é«˜äº®ï¼ˆH5é€‚ç”¨ï¼‰
- **æ¿€æ´»çŠ¶æ€**ï¼šæ˜æ˜¾é«˜äº®+å›¾æ ‡å˜åŒ–
- **ç¦ç”¨çŠ¶æ€**ï¼šç°è‰²æ˜¾ç¤º+ä¸å¯ç‚¹å‡»
- **åŠ è½½çŠ¶æ€**ï¼šæ˜¾ç¤ºåŠ è½½åŠ¨ç”»
- **éšè—çŠ¶æ€**ï¼šæƒé™ä¸è¶³æ—¶å®Œå…¨éšè—
- **å¾½ç« çŠ¶æ€**ï¼šæ˜¾ç¤ºæ¶ˆæ¯æé†’æˆ–æ›´æ–°æ ‡è¯†

**çŠ¶æ€æ ·å¼è§„èŒƒï¼š**
```scss
.menu-item {
  transition: all 0.3s ease;
  
  // é»˜è®¤çŠ¶æ€
  &.default {
    opacity: 1;
    transform: scale(1);
  }
  
  // æ¿€æ´»çŠ¶æ€
  &.active {
    background-color: var(--primary-color);
    color: #ffffff;
    transform: scale(1.05);
  }
  
  // ç¦ç”¨çŠ¶æ€
  &.disabled {
    opacity: 0.5;
    pointer-events: none;
  }
  
  // åŠ è½½çŠ¶æ€
  &.loading {
    position: relative;
    
    &::after {
      content: '';
      position: absolute;
      width: 16px;
      height: 16px;
      border: 2px solid #f3f3f3;
      border-top: 2px solid var(--primary-color);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
  }
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
```

### 5.2 æ‰‹åŠ¿äº¤äº’

**æ”¯æŒçš„æ‰‹åŠ¿ï¼š**
- **ç‚¹å‡»**ï¼šè¿›å…¥ä¸‹çº§èœå•æˆ–æ‰§è¡ŒåŠŸèƒ½
- **é•¿æŒ‰**ï¼šæ˜¾ç¤ºå¿«æ·æ“ä½œèœå•
- **æ»‘åŠ¨**ï¼šTabBar å·¦å³åˆ‡æ¢ï¼ˆå¯é€‰ï¼‰
- **ä¸‹æ‹‰åˆ·æ–°**ï¼šåˆ·æ–°èœå•æ•°æ®

**æ‰‹åŠ¿å®ç°ï¼š**
```vue
<template>
  <view 
    class="menu-item"
    @tap="onTap"
    @longpress="onLongPress"
    @touchstart="onTouchStart"
    @touchmove="onTouchMove"
    @touchend="onTouchEnd"
  >
    <!-- èœå•å†…å®¹ -->
  </view>
</template>

<script setup lang="ts">
let touchStartTime = 0
let touchStartX = 0
let touchStartY = 0

const onTap = () => {
  // ç‚¹å‡»å¤„ç†
}

const onLongPress = () => {
  // é•¿æŒ‰å¤„ç†
  uni.vibrateShort() // éœ‡åŠ¨åé¦ˆ
}

const onTouchStart = (event: TouchEvent) => {
  touchStartTime = Date.now()
  touchStartX = event.touches[0].clientX
  touchStartY = event.touches[0].clientY
}

const onTouchMove = (event: TouchEvent) => {
  // æ»‘åŠ¨å¤„ç†
}

const onTouchEnd = (event: TouchEvent) => {
  const touchEndTime = Date.now()
  const touchDuration = touchEndTime - touchStartTime
  
  if (touchDuration < 200) {
    // å¿«é€Ÿç‚¹å‡»
  }
}
</script>
```

## 6. å“åº”å¼è®¾è®¡

### 6.1 å±å¹•é€‚é…

**æ–­ç‚¹å®šä¹‰ï¼š**
```scss
// å±å¹•å°ºå¯¸æ–­ç‚¹
$breakpoints: (
  'small': 320px,   // å°å±æ‰‹æœº
  'medium': 375px,  // ä¸­ç­‰æ‰‹æœº
  'large': 414px,   // å¤§å±æ‰‹æœº
  'tablet': 768px   // å¹³æ¿
);

// å“åº”å¼æ··å…¥
@mixin respond-to($breakpoint) {
  @media (min-width: map-get($breakpoints, $breakpoint)) {
    @content;
  }
}

// èœå•å“åº”å¼æ ·å¼
.menu-grid {
  display: grid;
  gap: 16px;
  
  // å°å±ï¼š2åˆ—
  grid-template-columns: repeat(2, 1fr);
  
  // ä¸­ç­‰å±å¹•ï¼š3åˆ—
  @include respond-to('medium') {
    grid-template-columns: repeat(3, 1fr);
  }
  
  // å¤§å±ï¼š4åˆ—
  @include respond-to('large') {
    grid-template-columns: repeat(4, 1fr);
  }
}
```

### 6.2 åŠ¨æ€å¸ƒå±€

```typescript
// åŠ¨æ€è®¡ç®—èœå•å¸ƒå±€
interface LayoutConfig {
  columns: number
  itemSize: number
  gap: number
}

export function calculateMenuLayout(): LayoutConfig {
  const systemInfo = uni.getSystemInfoSync()
  const screenWidth = systemInfo.screenWidth
  const safeAreaWidth = screenWidth - 32 // å·¦å³è¾¹è·
  
  let columns = 2
  let itemSize = 80
  let gap = 16
  
  if (screenWidth >= 414) {
    columns = 4
    itemSize = 90
    gap = 20
  } else if (screenWidth >= 375) {
    columns = 3
    itemSize = 85
    gap = 18
  }
  
  // é‡æ–°è®¡ç®—ç¡®ä¿å®Œç¾é€‚é…
  const totalGap = (columns - 1) * gap
  const availableWidth = safeAreaWidth - totalGap
  itemSize = Math.floor(availableWidth / columns)
  
  return { columns, itemSize, gap }
}
```

## 7. æ€§èƒ½ä¼˜åŒ–

### 7.1 èœå•æ‡’åŠ è½½

```typescript
// èœå•æ•°æ®æ‡’åŠ è½½
interface MenuModule {
  id: string
  title: string
  component?: any
  children?: MenuModule[]
}

class MenuLoader {
  private loadedModules = new Map<string, any>()
  private loadingPromises = new Map<string, Promise<any>>()
  
  async loadMenuModule(moduleId: string): Promise<any> {
    if (this.loadedModules.has(moduleId)) {
      return this.loadedModules.get(moduleId)
    }
    
    // é¿å…é‡å¤åŠ è½½
    if (this.loadingPromises.has(moduleId)) {
      return this.loadingPromises.get(moduleId)
    }
    
    const loadingPromise = this.doLoadModule(moduleId)
    this.loadingPromises.set(moduleId, loadingPromise)
    
    try {
      const module = await loadingPromise
      this.loadedModules.set(moduleId, module)
      return module
    } finally {
      this.loadingPromises.delete(moduleId)
    }
  }
  
  private async doLoadModule(moduleId: string): Promise<any> {
    try {
      const module = await import(`@/pages/${moduleId}/index.vue`)
      return module
    } catch (error) {
      console.error(`Failed to load menu module: ${moduleId}`, error)
      throw error
    }
  }
  
  preloadMenuModules(moduleIds: string[]) {
    moduleIds.forEach(id => {
      this.loadMenuModule(id).catch(() => {
        // é¢„åŠ è½½å¤±è´¥ä¸å½±å“ä¸»æµç¨‹
      })
    })
  }
  
  // é¢„åŠ è½½ç”¨æˆ·å¸¸ç”¨èœå•
  async preloadFrequentMenus(userId: string) {
    try {
      const analytics = await uni.getStorageSync(`menu_analytics_${userId}`)
      const frequentMenus = analytics?.frequentMenus || ['slash-word', 'tools', 'profile']
      this.preloadMenuModules(frequentMenus)
    } catch (error) {
      console.warn('é¢„åŠ è½½å¸¸ç”¨èœå•å¤±è´¥:', error)
      this.preloadMenuModules(['slash-word', 'tools', 'profile'])
    }
  }
}

export const menuLoader = new MenuLoader()
```

### 7.2 èœå•ç¼“å­˜ç­–ç•¥

```typescript
// èœå•ç¼“å­˜ç®¡ç†
class MenuCache {
  private cache = new Map<string, any>()
  private cacheTimeout = 5 * 60 * 1000 // 5åˆ†é’Ÿ
  private maxCacheSize = 50 // æœ€å¤§ç¼“å­˜æ•°é‡
  
  set(key: string, data: any) {
    // æ£€æŸ¥ç¼“å­˜å¤§å°é™åˆ¶
    if (this.cache.size >= this.maxCacheSize) {
      this.evictLeastRecentlyUsed()
    }
    
    this.cache.set(key, {
      data,
      timestamp: Date.now(),
      accessCount: 1,
      lastAccess: Date.now()
    })
  }
  
  get(key: string): any | null {
    const cached = this.cache.get(key)
    if (!cached) return null
    
    const isExpired = Date.now() - cached.timestamp > this.cacheTimeout
    if (isExpired) {
      this.cache.delete(key)
      return null
    }
    
    // æ›´æ–°è®¿é—®ç»Ÿè®¡
    cached.accessCount++
    cached.lastAccess = Date.now()
    
    return cached.data
  }
  
  // LRUç¼“å­˜æ·˜æ±°ç­–ç•¥
  private evictLeastRecentlyUsed() {
    let lruKey = ''
    let oldestAccess = Date.now()
    
    for (const [key, value] of this.cache) {
      if (value.lastAccess < oldestAccess) {
        oldestAccess = value.lastAccess
        lruKey = key
      }
    }
    
    if (lruKey) {
      this.cache.delete(lruKey)
    }
  }
  
  clear() {
    this.cache.clear()
  }
  
  // è·å–ç¼“å­˜ç»Ÿè®¡ä¿¡æ¯
  getStats() {
    return {
      size: this.cache.size,
      maxSize: this.maxCacheSize,
      hitRate: this.calculateHitRate()
    }
  }
  
  private calculateHitRate(): number {
    let totalAccess = 0
    for (const [key, value] of this.cache) {
      totalAccess += value.accessCount
    }
    return totalAccess > 0 ? (this.cache.size / totalAccess) : 0
  }
}

export const menuCache = new MenuCache()
```

### 7.3 æ€§èƒ½ç›‘æ§

```typescript
// èœå•æ€§èƒ½ç›‘æ§
class MenuPerformanceMonitor {
  private metrics = new Map<string, any>()
  
  // è®°å½•èœå•åŠ è½½æ—¶é—´
  startTiming(menuId: string) {
    this.metrics.set(`${menuId}_start`, performance.now())
  }
  
  endTiming(menuId: string) {
    const startTime = this.metrics.get(`${menuId}_start`)
    if (startTime) {
      const duration = performance.now() - startTime
      this.recordMetric('menu_load_time', menuId, duration)
      this.metrics.delete(`${menuId}_start`)
    }
  }
  
  // è®°å½•èœå•ç‚¹å‡»äº‹ä»¶
  recordMenuClick(menuId: string) {
    this.recordMetric('menu_click', menuId, 1)
  }
  
  // è®°å½•æ€§èƒ½æŒ‡æ ‡
  private recordMetric(type: string, menuId: string, value: number) {
    const key = `${type}_${menuId}`
    const existing = this.metrics.get(key) || { count: 0, total: 0, avg: 0 }
    
    existing.count++
    existing.total += value
    existing.avg = existing.total / existing.count
    
    this.metrics.set(key, existing)
  }
  
  // è·å–æ€§èƒ½æŠ¥å‘Š
  getPerformanceReport() {
    const report: any = {}
    
    for (const [key, value] of this.metrics) {
      if (key.includes('menu_load_time')) {
        const menuId = key.replace('menu_load_time_', '')
        report[menuId] = {
          averageLoadTime: value.avg,
          loadCount: value.count
        }
      }
    }
    
    return report
  }
}

export const performanceMonitor = new MenuPerformanceMonitor()
```

## 8. æ— éšœç¢è®¿é—®

### 8.1 æ— éšœç¢å±æ€§

```vue
<template>
  <view 
    class="menu-item"
    role="button"
    :aria-label="menuItem.title"
    :aria-describedby="menuItem.description"
    tabindex="0"
    @click="onMenuClick"
    @keydown.enter="onMenuClick"
    @keydown.space="onMenuClick"
  >
    <image 
      :src="menuItem.icon"
      :alt="menuItem.title"
      class="menu-icon"
    />
    <text class="menu-title">{{ menuItem.title }}</text>
    <text 
      :id="menuItem.description"
      class="menu-description sr-only"
    >
      {{ menuItem.description }}
    </text>
  </view>
</template>

<style>
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}
</style>
```

### 8.2 é”®ç›˜å¯¼èˆª

```typescript
// é”®ç›˜å¯¼èˆªæ”¯æŒ
export function useKeyboardNavigation() {
  const currentFocusIndex = ref(0)
  const menuItems = ref<HTMLElement[]>([])
  
  const handleKeyDown = (event: KeyboardEvent) => {
    switch (event.key) {
      case 'ArrowDown':
        event.preventDefault()
        focusNext()
        break
      case 'ArrowUp':
        event.preventDefault()
        focusPrevious()
        break
      case 'Home':
        event.preventDefault()
        focusFirst()
        break
      case 'End':
        event.preventDefault()
        focusLast()
        break
    }
  }
  
  const focusNext = () => {
    currentFocusIndex.value = Math.min(
      currentFocusIndex.value + 1,
      menuItems.value.length - 1
    )
    focusCurrent()
  }
  
  const focusPrevious = () => {
    currentFocusIndex.value = Math.max(currentFocusIndex.value - 1, 0)
    focusCurrent()
  }
  
  const focusFirst = () => {
    currentFocusIndex.value = 0
    focusCurrent()
  }
  
  const focusLast = () => {
    currentFocusIndex.value = menuItems.value.length - 1
    focusCurrent()
  }
  
  const focusCurrent = () => {
    const currentItem = menuItems.value[currentFocusIndex.value]
    if (currentItem) {
      currentItem.focus()
    }
  }
  
  return {
    handleKeyDown,
    currentFocusIndex
  }
}
```

## 9. æµ‹è¯•è§„èŒƒ

### 9.1 èœå•åŠŸèƒ½æµ‹è¯•

```typescript
// èœå•ç»„ä»¶æµ‹è¯•
import { mount } from '@vue/test-utils'
import MenuComponent from '@/components/Menu.vue'

describe('Menu Component', () => {
  it('should render menu items correctly', () => {
    const menuItems = [
      { id: '1', title: 'å­¦ä¹ ', icon: '/icons/study.png' },
      { id: '2', title: 'è¿›åº¦', icon: '/icons/progress.png' }
    ]
    
    const wrapper = mount(MenuComponent, {
      props: { items: menuItems }
    })
    
    expect(wrapper.findAll('.menu-item')).toHaveLength(2)
    expect(wrapper.text()).toContain('å­¦ä¹ ')
    expect(wrapper.text()).toContain('è¿›åº¦')
  })
  
  it('should handle menu item click', async () => {
    const wrapper = mount(MenuComponent, {
      props: {
        items: [{ id: '1', title: 'å­¦ä¹ ', icon: '/icons/study.png' }]
      }
    })
    
    await wrapper.find('.menu-item').trigger('click')
    
    expect(wrapper.emitted('menu-click')).toBeTruthy()
    expect(wrapper.emitted('menu-click')[0]).toEqual([{ id: '1' }])
  })
  
  it('should support keyboard navigation', async () => {
    const wrapper = mount(MenuComponent, {
      props: {
        items: [
          { id: '1', title: 'å­¦ä¹ ', icon: '/icons/study.png' },
          { id: '2', title: 'è¿›åº¦', icon: '/icons/progress.png' }
        ]
      }
    })
    
    const firstItem = wrapper.find('.menu-item')
    await firstItem.trigger('keydown', { key: 'ArrowDown' })
    
    // éªŒè¯ç„¦ç‚¹ç§»åŠ¨
    expect(wrapper.vm.currentFocusIndex).toBe(1)
  })
})
```

### 9.2 æƒé™æµ‹è¯•

```typescript
// æƒé™ç›¸å…³æµ‹è¯•
import { useAuthStore } from '@/store/modules/auth'
import { useMenuStore } from '@/store/modules/menu'

describe('Menu Permissions', () => {
  it('should show correct menus for student role', () => {
    const authStore = useAuthStore()
    const menuStore = useMenuStore()
    
    authStore.setUserRole('student')
    const visibleMenus = menuStore.getVisibleMenus()
    
    expect(visibleMenus).toContain('learning')
    expect(visibleMenus).toContain('progress')
    expect(visibleMenus).not.toContain('admin')
  })
  
  it('should show admin menus for admin role', () => {
    const authStore = useAuthStore()
    const menuStore = useMenuStore()
    
    authStore.setUserRole('admin')
    const visibleMenus = menuStore.getVisibleMenus()
    
    expect(visibleMenus).toContain('admin')
    expect(visibleMenus).toContain('user-management')
  })
})
```

## 10. æœ€ä½³å®è·µæ€»ç»“

### 10.1 è®¾è®¡å»ºè®®

1. **å±‚çº§æ§åˆ¶**ï¼šèœå•æ·±åº¦ä¸è¶…è¿‡4çº§ï¼Œé¿å…ç”¨æˆ·è¿·å¤±
2. **åŠŸèƒ½èšåˆ**ï¼šç›¸å…³åŠŸèƒ½å½’ç±»ï¼Œå‡å°‘è®¤çŸ¥è´Ÿæ‹…
3. **è§†è§‰å±‚æ¬¡**ï¼šä½¿ç”¨é¢œè‰²ã€å¤§å°ã€é—´è·å»ºç«‹æ¸…æ™°å±‚æ¬¡
4. **ä¸€è‡´æ€§**ï¼šä¿æŒå›¾æ ‡ã€æ–‡å­—ã€äº¤äº’çš„ä¸€è‡´æ€§
5. **åé¦ˆåŠæ—¶**ï¼šæä¾›æ¸…æ™°çš„çŠ¶æ€åé¦ˆå’ŒåŠ è½½æç¤º

### 10.2 å¼€å‘å»ºè®®

1. **ç»„ä»¶åŒ–**ï¼šèœå•åŠŸèƒ½æ¨¡å—åŒ–ï¼Œä¾¿äºç»´æŠ¤å’Œå¤ç”¨
2. **æ•°æ®é©±åŠ¨**ï¼šèœå•é…ç½®æ•°æ®åŒ–ï¼Œæ”¯æŒåŠ¨æ€æ›´æ–°
3. **æ€§èƒ½ä¼˜åŒ–**ï¼šåˆç†ä½¿ç”¨ç¼“å­˜å’Œæ‡’åŠ è½½
4. **æµ‹è¯•è¦†ç›–**ï¼šç¡®ä¿èœå•åŠŸèƒ½å’Œæƒé™çš„æµ‹è¯•è¦†ç›–
5. **æ— éšœç¢**ï¼šè€ƒè™‘ç‰¹æ®Šç”¨æˆ·ç¾¤ä½“çš„ä½¿ç”¨éœ€æ±‚

### 10.3 ç»´æŠ¤å»ºè®®

1. **ç‰ˆæœ¬æ§åˆ¶**ï¼šèœå•é…ç½®å˜æ›´éœ€è¦ç‰ˆæœ¬ç®¡ç†
2. **æ–‡æ¡£æ›´æ–°**ï¼šåŠæ—¶æ›´æ–°èœå•è®¾è®¡æ–‡æ¡£
3. **ç”¨æˆ·åé¦ˆ**ï¼šæ”¶é›†ç”¨æˆ·ä½¿ç”¨åé¦ˆï¼ŒæŒç»­ä¼˜åŒ–
4. **æ€§èƒ½ç›‘æ§**ï¼šç›‘æ§èœå•åŠ è½½æ€§èƒ½å’Œç”¨æˆ·è¡Œä¸º
5. **å®šæœŸå®¡æŸ¥**ï¼šå®šæœŸå®¡æŸ¥èœå•ç»“æ„çš„åˆç†æ€§

---

æœ¬è§„èŒƒå°†éšç€äº§å“å‘å±•å’Œç”¨æˆ·åé¦ˆæŒç»­ä¼˜åŒ–ï¼Œç¡®ä¿å°ç¨‹åºèœå•ç³»ç»Ÿçš„ç”¨æˆ·ä½“éªŒå’Œå¼€å‘æ•ˆç‡ã€‚