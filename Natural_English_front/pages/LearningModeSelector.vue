<template>
  <div class="learning-mode-selector">
    <!-- å‡ ä½•èƒŒæ™¯è£…é¥°å±‚ -->
    <div class="geometric-background">
      <div class="geometric-shape shape-1"></div>
      <div class="geometric-shape shape-2"></div>
      <div class="geometric-shape shape-3"></div>
      <div class="geometric-shape shape-4"></div>
      <div class="geometric-shape shape-5"></div>
      <div class="geometric-shape shape-6"></div>
    </div>
    
    <div class="header">
      <h1>è‹±è¯­å­¦ä¹ ä¸­å¿ƒ</h1>
      <p class="subtitle">é€‰æ‹©æ‚¨çš„å­¦ä¹ æ¨¡å¼</p>
    </div>
    
    <!-- åˆ†ç±»æ ‡é¢˜ -->
    <div class="category-section">
      <h2 class="category-title">ğŸ“š å­¦ä¹ æ¨¡å—</h2>
      <div class="mode-grid">
        <!-- å•è¯é˜…è¯» -->
        <div v-if="canUseMode('word-reading')" class="mode-card" @click="navigateToMode('word-reading')">
          <div class="mode-header">
            <div class="mode-icon">ğŸ“–</div>
            <div class="mode-title">å•è¯é˜…è¯»</div>
            <div class="homepage-selector">
              <input 
                type="radio" 
                name="homepage" 
                value="word-reading"
                v-model="selectedHomepage"
                @change="setHomepage('word-reading')"
                @click.stop
              >
              <label>è®¾ä¸ºé¦–é¡µ</label>
            </div>
          </div>
          <div class="mode-description">
            <p>H5ç‰ˆå•è¯é˜…è¯»é¡µé¢ï¼Œæ”¯æŒéŸ³é¢‘æ’­æ”¾å’Œè¿›åº¦è·Ÿè¸ª</p>
            <div class="mode-features">
              <span class="feature-tag">éŸ³é¢‘æ’­æ”¾</span>
              <span class="feature-tag">è¿›åº¦è·Ÿè¸ª</span>
              <span class="feature-tag">å‘éŸ³ç»ƒä¹ </span>
            </div>
          </div>
          <div class="mode-stats">
            <div class="stat-item">
              <span class="stat-label">é€‚åˆäººç¾¤</span>
              <span class="stat-value">å‘éŸ³ç»ƒä¹ </span>
            </div>
          </div>
        </div>

        <!-- å•è¯å­¦ä¹  -->
        <div v-if="canUseMode('word-learning')" class="mode-card" @click="navigateToMode('word-learning')">
          <div class="mode-header">
            <div class="mode-icon">ğŸ“š</div>
            <div class="mode-title">å•è¯å­¦ä¹ </div>
            <div class="homepage-selector">
              <input 
                type="radio" 
                name="homepage" 
                value="word-learning"
                v-model="selectedHomepage"
                @change="setHomepage('word-learning')"
                @click.stop
              >
              <label>è®¾ä¸ºé¦–é¡µ</label>
            </div>
          </div>
          <div class="mode-description">
            <p>H5ç‰ˆå•è¯å­¦ä¹ é¡µé¢ï¼Œå±•ç¤ºå•è¯è¯¦æƒ…å’Œå¤šç§é‡Šä¹‰</p>
            <div class="mode-features">
              <span class="feature-tag">è¯¦ç»†é‡Šä¹‰</span>
              <span class="feature-tag">ä¾‹å¥å±•ç¤º</span>
              <span class="feature-tag">è¯æ±‡ç§¯ç´¯</span>
            </div>
          </div>
          <div class="mode-stats">
            <div class="stat-item">
              <span class="stat-label">é€‚åˆäººç¾¤</span>
              <span class="stat-value">ç³»ç»Ÿå­¦ä¹ </span>
            </div>
          </div>
        </div>

        <!-- å•è¯è¯¦æƒ… -->
        <div v-if="canUseMode('word-detail')" class="mode-card" @click="navigateToMode('word-detail')">
          <div class="mode-header">
            <div class="mode-icon">ğŸ“</div>
            <div class="mode-title">å•è¯è¯¦æƒ…</div>
            <div class="homepage-selector">
              <input 
                type="radio" 
                name="homepage" 
                value="word-detail"
                v-model="selectedHomepage"
                @change="setHomepage('word-detail')"
                @click.stop
              >
              <label>è®¾ä¸ºé¦–é¡µ</label>
            </div>
          </div>
          <div class="mode-description">
            <p>å•è¯è¯¦æƒ…é¡µé¢ï¼ŒåŒ…å«éŸ³æ ‡ã€é‡Šä¹‰ã€ä¾‹å¥ã€è¯æ ¹è¯ç¼€ç­‰å®Œæ•´ä¿¡æ¯</p>
            <div class="mode-features">
              <span class="feature-tag">éŸ³æ ‡æ ‡æ³¨</span>
              <span class="feature-tag">è¯æ ¹åˆ†æ</span>
              <span class="feature-tag">ä¾‹å¥ä¸°å¯Œ</span>
            </div>
          </div>
          <div class="mode-stats">
            <div class="stat-item">
              <span class="stat-label">é€‚åˆäººç¾¤</span>
              <span class="stat-value">æ·±åº¦å­¦ä¹ </span>
            </div>
          </div>
        </div>

        <!-- è¯æ ¹åˆ†è§£ -->
        <div v-if="canUseMode('word-root-analysis')" class="mode-card" @click="navigateToMode('word-root-analysis')">
          <div class="mode-header">
            <div class="mode-icon">ğŸŒ±</div>
            <div class="mode-title">è¯æ ¹åˆ†è§£</div>
            <div class="homepage-selector">
              <input 
                type="radio" 
                name="homepage" 
                value="word-root-analysis"
                v-model="selectedHomepage"
                @change="setHomepage('word-root-analysis')"
                @click.stop
              >
              <label>è®¾ä¸ºé¦–é¡µ</label>
            </div>
          </div>
          <div class="mode-description">
            <p>è¯æ ¹æ‹†è§£å±•ç¤ºé¡µé¢ï¼Œæ”¯æŒè¯æ ¹åˆ†æå’Œå­¦ä¹ è¿›åº¦ç®¡ç†</p>
            <div class="mode-features">
              <span class="feature-tag">è¯æ ¹æ‹†è§£</span>
              <span class="feature-tag">è¯ç¼€åˆ†æ</span>
              <span class="feature-tag">è®°å¿†æŠ€å·§</span>
            </div>
          </div>
          <div class="mode-stats">
            <div class="stat-item">
              <span class="stat-label">é€‚åˆäººç¾¤</span>
              <span class="stat-value">è¯æ±‡æ‰©å±•</span>
            </div>
          </div>
        </div>

        <!-- æ•…äº‹é˜…è¯» -->
        <div v-if="canUseMode('story-reading')" class="mode-card" @click="navigateToMode('story-reading')">
          <div class="mode-header">
            <div class="mode-icon">ğŸ“š</div>
            <div class="mode-title">æ•…äº‹é˜…è¯»</div>
            <div class="homepage-selector">
              <input 
                type="radio" 
                name="homepage" 
                value="story-reading"
                v-model="selectedHomepage"
                @change="setHomepage('story-reading')"
                @click.stop
              >
              <label>è®¾ä¸ºé¦–é¡µ</label>
            </div>
          </div>
          <div class="mode-description">
            <p>äº¤äº’å¼æ•…äº‹é˜…è¯»é¡µé¢ï¼Œæ”¯æŒè¯æ€§æ ‡æ³¨å’Œç”Ÿè¯æ”¶é›†åŠŸèƒ½</p>
            <div class="mode-features">
              <span class="feature-tag">è¯æ€§æ ‡æ³¨</span>
              <span class="feature-tag">ç”Ÿè¯æ”¶é›†</span>
              <span class="feature-tag">æƒ…å¢ƒå­¦ä¹ </span>
            </div>
          </div>
          <div class="mode-stats">
            <div class="stat-item">
              <span class="stat-label">é€‚åˆäººç¾¤</span>
              <span class="stat-value">é˜…è¯»æå‡</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ç»ƒä¹ æ¨¡å— -->
    <div class="category-section">
      <h2 class="category-title">âœï¸ ç»ƒä¹ æ¨¡å—</h2>
      <div class="mode-grid">

        <!-- æ‹¼å†™ç»ƒä¹  -->
        <div v-if="canUseMode('spelling')" class="mode-card" @click="navigateToMode('spelling')">
          <div class="mode-header">
            <div class="mode-icon">âœï¸</div>
            <div class="mode-title">æ‹¼å†™ç»ƒä¹ </div>
            <div class="homepage-selector">
              <input 
                type="radio" 
                name="homepage" 
                value="spelling"
                v-model="selectedHomepage"
                @change="setHomepage('spelling')"
                @click.stop
              >
              <label>è®¾ä¸ºé¦–é¡µ</label>
            </div>
          </div>
          <div class="mode-description">
            <p>å¬éŸ³æ‹¼å†™ç»ƒä¹ é¡µé¢ï¼Œæå‡å•è¯è®°å¿†</p>
            <div class="mode-features">
              <span class="feature-tag">å¬éŸ³ç»ƒä¹ </span>
              <span class="feature-tag">æ‹–æ‹½æ‹¼å†™</span>
              <span class="feature-tag">è®°å¿†å¼ºåŒ–</span>
            </div>
          </div>
          <div class="mode-stats">
            <div class="stat-item">
              <span class="stat-label">é€‚åˆäººç¾¤</span>
              <span class="stat-value">æ‹¼å†™ç»ƒä¹ </span>
            </div>
          </div>
        </div>

        <!-- é—ªå¡å­¦ä¹  -->
        <div v-if="canUseMode('flashcard')" class="mode-card" @click="navigateToMode('flashcard')">
          <div class="mode-header">
            <div class="mode-icon">ğŸƒ</div>
            <div class="mode-title">é—ªå¡å­¦ä¹ </div>
            <div class="homepage-selector">
              <input 
                type="radio" 
                name="homepage" 
                value="flashcard"
                v-model="selectedHomepage"
                @change="setHomepage('flashcard')"
                @click.stop
              >
              <label>è®¾ä¸ºé¦–é¡µ</label>
            </div>
          </div>
          <div class="mode-description">
            <p>ç¿»è½¬å¡ç‰‡å­¦ä¹ å•è¯é¡µé¢</p>
            <div class="mode-features">
              <span class="feature-tag">å¡ç‰‡ç¿»è½¬</span>
              <span class="feature-tag">å¿«é€Ÿè®°å¿†</span>
              <span class="feature-tag">é‡å¤ç»ƒä¹ </span>
            </div>
          </div>
          <div class="mode-stats">
            <div class="stat-item">
              <span class="stat-label">é€‚åˆäººç¾¤</span>
              <span class="stat-value">å¿«é€Ÿè®°å¿†</span>
            </div>
          </div>
        </div>

        <!-- æ¨¡å¼åŒ¹é…è®°å¿† -->
        <div v-if="canUseMode('pattern-memory')" class="mode-card" @click="navigateToMode('pattern-memory')">
          <div class="mode-header">
            <div class="mode-icon">ğŸ§ </div>
            <div class="mode-title">æ¨¡å¼åŒ¹é…è®°å¿†</div>
            <div class="homepage-selector">
              <input 
                type="radio" 
                name="homepage" 
                value="pattern-memory"
                v-model="selectedHomepage"
                @change="setHomepage('pattern-memory')"
                @click.stop
              >
              <label>è®¾ä¸ºé¦–é¡µ</label>
            </div>
          </div>
          <div class="mode-description">
            <p>ä¸‰çº§å­¦ä¹ æ¨¡å¼ï¼šå›¾ç‰‡é€‰æ‹©ã€é€‰æ‹©é¢˜ã€å•è¯è¡¥å…¨ï¼Œæ”¯æŒå¤šç§è®°å¿†æ–¹å¼</p>
            <div class="mode-features">
              <span class="feature-tag">å›¾ç‰‡é€‰æ‹©</span>
              <span class="feature-tag">é€‰æ‹©é¢˜</span>
              <span class="feature-tag">å•è¯è¡¥å…¨</span>
            </div>
          </div>
          <div class="mode-stats">
            <div class="stat-item">
              <span class="stat-label">é€‚åˆäººç¾¤</span>
              <span class="stat-value">ç³»ç»Ÿå­¦ä¹ </span>
            </div>
          </div>
        </div>

        <!-- å•è¯æŒ‘æˆ˜ -->
        <div v-if="canUseMode('word-challenge')" class="mode-card" @click="navigateToMode('word-challenge')">
          <div class="mode-header">
            <div class="mode-icon">âš”ï¸</div>
            <div class="mode-title">å•è¯æŒ‘æˆ˜</div>
            <div class="homepage-selector">
              <input 
                type="radio" 
                name="homepage" 
                value="word-challenge"
                v-model="selectedHomepage"
                @change="setHomepage('word-challenge')"
                @click.stop
              >
              <label>è®¾ä¸ºé¦–é¡µ</label>
            </div>
          </div>
          <div class="mode-description">
            <p>å•è¯æŒ‘æˆ˜æ¸¸æˆé¡µé¢</p>
            <div class="mode-features">
              <span class="feature-tag">æ¸¸æˆåŒ–</span>
              <span class="feature-tag">æŒ‘æˆ˜æ¨¡å¼</span>
              <span class="feature-tag">ç«æŠ€å¯¹æˆ˜</span>
            </div>
          </div>
          <div class="mode-stats">
            <div class="stat-item">
              <span class="stat-label">é€‚åˆäººç¾¤</span>
              <span class="stat-value">ç«æŠ€æŒ‘æˆ˜</span>
            </div>
          </div>
        </div>

        <!-- å•è¯å¤ä¹  -->
        <div v-if="canUseMode('word-review')" class="mode-card" @click="navigateToMode('word-review')">
          <div class="mode-header">
            <div class="mode-icon">ğŸ”„</div>
            <div class="mode-title">å•è¯å¤ä¹ </div>
            <div class="homepage-selector">
              <input 
                type="radio" 
                name="homepage" 
                value="word-review"
                v-model="selectedHomepage"
                @change="setHomepage('word-review')"
                @click.stop
              >
              <label>è®¾ä¸ºé¦–é¡µ</label>
            </div>
          </div>
          <div class="mode-description">
            <p>å•è¯å¤ä¹ é¡µé¢</p>
            <div class="mode-features">
              <span class="feature-tag">å¤ä¹ è®¡åˆ’</span>
              <span class="feature-tag">é—å¿˜æ›²çº¿</span>
              <span class="feature-tag">æ™ºèƒ½æ¨è</span>
            </div>
          </div>
          <div class="mode-stats">
            <div class="stat-item">
              <span class="stat-label">é€‚åˆäººç¾¤</span>
              <span class="stat-value">å·©å›ºå¤ä¹ </span>
            </div>
          </div>
        </div>

        <!-- å•è¯é€‰æ‹© -->
        <div v-if="canUseMode('word-selection')" class="mode-card" @click="navigateToMode('word-selection')">
          <div class="mode-header">
            <div class="mode-icon">âœ…</div>
            <div class="mode-title">å•è¯é€‰æ‹©</div>
            <div class="homepage-selector">
              <input 
                type="radio" 
                name="homepage" 
                value="word-selection"
                v-model="selectedHomepage"
                @change="setHomepage('word-selection')"
                @click.stop
              >
              <label>è®¾ä¸ºé¦–é¡µ</label>
            </div>
          </div>
          <div class="mode-description">
            <p>å•è¯é€‰æ‹©ç»ƒä¹ é¡µé¢</p>
            <div class="mode-features">
              <span class="feature-tag">é€‰æ‹©é¢˜</span>
              <span class="feature-tag">å¿«é€Ÿåˆ¤æ–­</span>
              <span class="feature-tag">å‡†ç¡®ç‡ç»Ÿè®¡</span>
            </div>
          </div>
          <div class="mode-stats">
            <div class="stat-item">
              <span class="stat-label">é€‚åˆäººç¾¤</span>
              <span class="stat-value">å¿«é€Ÿç»ƒä¹ </span>
            </div>
          </div>
        </div>

        <!-- å¸ˆç”Ÿäº’åŠ¨ -->
        <div v-if="canUseMode('teacher-student-interaction')" class="mode-card" @click="navigateToMode('teacher-student-interaction')">
          <div class="mode-header">
            <div class="mode-icon">ğŸ‘¥</div>
            <div class="mode-title">å¸ˆç”Ÿäº’åŠ¨</div>
            <div class="homepage-selector">
              <input 
                type="radio" 
                name="homepage" 
                value="teacher-student-interaction"
                v-model="selectedHomepage"
                @change="setHomepage('teacher-student-interaction')"
                @click.stop
              >
              <label>è®¾ä¸ºé¦–é¡µ</label>
            </div>
          </div>
          <div class="mode-description">
            <p>å¸ˆç”Ÿäº’åŠ¨ç»ƒä¹ æ¨¡å¼ï¼Œæ”¯æŒå•è¯é€‰æ‹©å’Œå®æ—¶åé¦ˆ</p>
            <div class="mode-features">
              <span class="feature-tag">å¸ˆç”Ÿäº’åŠ¨</span>
              <span class="feature-tag">å®æ—¶åé¦ˆ</span>
              <span class="feature-tag">åä½œå­¦ä¹ </span>
            </div>
          </div>
          <div class="mode-stats">
            <div class="stat-item">
              <span class="stat-label">é€‚åˆäººç¾¤</span>
              <span class="stat-value">è¯¾å ‚æ•™å­¦</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ç‰¹è‰²æ¨¡å— -->
    <div class="category-section">
      <h2 class="category-title">ğŸ† ç‰¹è‰²æ¨¡å—</h2>
      <div class="mode-grid">
        <!-- ç«æŠ€æ¨¡å¼ -->
        <div v-if="canUseMode('competition')" class="mode-card" @click="navigateToMode('competition')">
          <div class="mode-header">
            <div class="mode-icon">ğŸ†</div>
            <div class="mode-title">ç«æŠ€æ¨¡å¼</div>
            <div class="homepage-selector">
              <input 
                type="radio" 
                name="homepage" 
                value="competition"
                v-model="selectedHomepage"
                @change="setHomepage('competition')"
                @click.stop
              >
              <label>è®¾ä¸ºé¦–é¡µ</label>
            </div>
          </div>
          <div class="mode-description">
            <p>ä¸å…¶ä»–å­¦ä¹ è€…ç«æŠ€å¯¹æˆ˜ï¼Œå›¢é˜ŸæŒ‘æˆ˜</p>
            <div class="mode-features">
              <span class="feature-tag">å®æ—¶å¯¹æˆ˜</span>
              <span class="feature-tag">å›¢é˜ŸæŒ‘æˆ˜</span>
              <span class="feature-tag">æ’è¡Œæ¦œ</span>
            </div>
          </div>
          <div class="mode-stats">
            <div class="stat-item">
              <span class="stat-label">é€‚åˆäººç¾¤</span>
              <span class="stat-value">ç«æŠ€æŒ‘æˆ˜</span>
            </div>
          </div>
        </div>

        <!-- å¿«åˆ·æ¨¡å¼ -->
        <div v-if="canUseMode('quick-brush')" class="mode-card" @click="navigateToMode('quick-brush')">
          <div class="mode-header">
            <div class="mode-icon">âš¡</div>
            <div class="mode-title">å¿«åˆ·æ¨¡å¼</div>
            <div class="homepage-selector">
              <input 
                type="radio" 
                name="homepage" 
                value="quick-brush"
                v-model="selectedHomepage"
                @change="setHomepage('quick-brush')"
                @click.stop
              >
              <label>è®¾ä¸ºé¦–é¡µ</label>
            </div>
          </div>
          <div class="mode-description">
            <p>å¿«é€Ÿåˆ·é¢˜æ¨¡å¼ï¼Œè‡ªåŠ¨è·³è½¬ä¸‹ä¸€é¢˜ï¼Œæå‡å­¦ä¹ æ•ˆç‡</p>
            <div class="mode-features">
              <span class="feature-tag">å®æ—¶è®¡æ—¶</span>
              <span class="feature-tag">è‡ªåŠ¨è·³è½¬</span>
              <span class="feature-tag">å¿«é€Ÿåé¦ˆ</span>
            </div>
          </div>
          <div class="mode-stats">
            <div class="stat-item">
              <span class="stat-label">é€‚åˆäººç¾¤</span>
              <span class="stat-value">å¿«é€Ÿå¤ä¹ </span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- å½“å‰é¦–é¡µè®¾ç½®æç¤º -->
    <div v-if="selectedHomepage" class="homepage-tip">
      <div class="tip-content">
        <span class="tip-icon">ğŸ </span>
        <span class="tip-text">å½“å‰é¦–é¡µï¼š{{ getModeName(selectedHomepage) }}</span>
        <button @click="clearHomepage" class="clear-btn">æ¸…é™¤è®¾ç½®</button>
      </div>
    </div>
  </div>
</template>

<style scoped>
.learning-mode-selector {
  min-height: 100vh;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  position: relative;
  overflow: hidden;
  padding: 20px;
}

/* å‡ ä½•èƒŒæ™¯è£…é¥° */
.geometric-background {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 1;
  pointer-events: none;
}

.geometric-shape {
  position: absolute;
  opacity: 0.1;
  animation: float 6s ease-in-out infinite;
}

.shape-1 {
  top: 10%;
  left: 10%;
  width: 80px;
  height: 80px;
  background: linear-gradient(45deg, #fff, transparent);
  border-radius: 50%;
  animation-delay: 0s;
}

.shape-2 {
  top: 20%;
  right: 15%;
  width: 60px;
  height: 60px;
  background: linear-gradient(45deg, #fff, transparent);
  transform: rotate(45deg);
  animation-delay: 1s;
}

.shape-3 {
  bottom: 30%;
  left: 20%;
  width: 100px;
  height: 100px;
  border: 2px solid rgba(255, 255, 255, 0.3);
  border-radius: 50%;
  animation-delay: 2s;
}

.shape-4 {
  bottom: 20%;
  right: 10%;
  width: 70px;
  height: 70px;
  background: linear-gradient(45deg, #fff, transparent);
  clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
  animation-delay: 3s;
}

.shape-5 {
  top: 50%;
  left: 5%;
  width: 50px;
  height: 50px;
  background: linear-gradient(45deg, #fff, transparent);
  transform: rotate(45deg);
  animation-delay: 4s;
}

.shape-6 {
  top: 70%;
  right: 25%;
  width: 90px;
  height: 90px;
  border: 2px solid rgba(255, 255, 255, 0.2);
  transform: rotate(30deg);
  animation-delay: 5s;
}

@keyframes float {
  0%, 100% {
    transform: translateY(0px) rotate(0deg);
  }
  50% {
    transform: translateY(-20px) rotate(180deg);
  }
}

/* ä¸»è¦å†…å®¹åŒºåŸŸ */
.header {
  text-align: center;
  margin-bottom: 3rem;
  position: relative;
  z-index: 2;
}

.header h1 {
  color: white;
  font-size: 3rem;
  font-weight: 700;
  margin-bottom: 0.5rem;
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
}

.subtitle {
  color: rgba(255, 255, 255, 0.9);
  font-size: 1.25rem;
  font-weight: 400;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
}

.category-section {
  margin-bottom: 3rem;
  position: relative;
  z-index: 2;
}

.mode-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 2rem;
  margin-bottom: 2rem;
}

.content {
  position: relative;
  z-index: 2;
  max-width: 1200px;
  margin: 0 auto;
}

.category-title {
  color: white;
  font-size: 2.5rem;
  font-weight: 700;
  text-align: center;
  margin-bottom: 3rem;
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
}

.modes-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 2rem;
  margin-bottom: 3rem;
}

.mode-card {
  background: rgba(255, 255, 255, 0.95);
  border-radius: 16px;
  padding: 2rem;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  cursor: pointer;
}

.mode-card:hover {
  transform: translateY(-8px);
  box-shadow: 0 16px 48px rgba(0, 0, 0, 0.2);
}

.mode-icon {
  font-size: 3rem;
  margin-bottom: 1rem;
  display: block;
  text-align: center;
}

.mode-title {
  font-size: 1.5rem;
  font-weight: 600;
  color: #333;
  margin-bottom: 1rem;
  text-align: center;
}

.mode-header {
  display: flex;
  flex-direction: column;
  align-items: center;
  margin-bottom: 1rem;
  position: relative;
}

.mode-description {
  color: #666;
  line-height: 1.6;
  text-align: center;
  margin-bottom: 1.5rem;
}

.mode-features {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
  justify-content: center;
  margin-top: 1rem;
}

.feature-tag {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 0.25rem 0.75rem;
  border-radius: 12px;
  font-size: 0.75rem;
  font-weight: 500;
  white-space: nowrap;
}

.mode-stats {
  margin-top: 1rem;
  padding-top: 1rem;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.stat-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 0.5rem;
}

.stat-label {
  color: #888;
  font-size: 0.875rem;
  font-weight: 500;
}

.stat-value {
  color: #333;
  font-size: 0.875rem;
  font-weight: 600;
}

.homepage-selector {
  position: absolute;
  top: 0;
  right: 0;
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 0.75rem;
  color: #666;
}

.homepage-selector input[type="radio"] {
  margin: 0;
  width: 14px;
  height: 14px;
}

.homepage-selector label {
  margin: 0;
  cursor: pointer;
  user-select: none;
}

.mode-button {
  width: 100%;
  padding: 12px 24px;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  border: none;
  border-radius: 8px;
  font-size: 16px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.3s ease;
}

.mode-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
}

.homepage-tip {
  background: rgba(255, 255, 255, 0.9);
  border-radius: 12px;
  padding: 1.5rem;
  text-align: center;
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.3);
  position: relative;
  z-index: 2;
}

.tip-content {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 1rem;
  flex-wrap: wrap;
}

.tip-icon {
  font-size: 1.5rem;
}

.clear-btn {
  background: rgba(255, 59, 48, 0.1);
  color: #ff3b30;
  border: 1px solid #ff3b30;
  border-radius: 6px;
  padding: 0.5rem 1rem;
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.3s ease;
}

.clear-btn:hover {
  background: #ff3b30;
  color: white;
}

.tip-text {
  color: #555;
  font-size: 1.1rem;
  margin-bottom: 1rem;
}

.tip-button {
  padding: 10px 20px;
  background: rgba(102, 126, 234, 0.1);
  color: #667eea;
  border: 1px solid #667eea;
  border-radius: 6px;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.3s ease;
}

.tip-button:hover {
  background: #667eea;
  color: white;
}

/* å“åº”å¼è®¾è®¡ */
@media (max-width: 768px) {
  .learning-mode-selector {
    padding: 16px;
  }
  
  .category-title {
    font-size: 2rem;
    margin-bottom: 2rem;
  }
  
  .modes-grid {
    grid-template-columns: 1fr;
    gap: 1.5rem;
  }
  
  .mode-card {
    padding: 1.5rem;
  }
  
  .mode-icon {
    font-size: 2.5rem;
  }
  
  .mode-title {
    font-size: 1.25rem;
  }
}

@media (max-width: 480px) {
  .category-title {
    font-size: 1.75rem;
  }
  
  .mode-card {
    padding: 1.25rem;
  }
  
  .mode-icon {
    font-size: 2rem;
  }
}
</style>

<script>
import { UserSettingsManager } from '../utils/userSettings'
import userPersonalizationMixin, { predefinedElementConfigs } from '../mixins/userPersonalization'
import permissionMixin from '../mixins/permissionMixin'
import { homepageManager } from '../utils/homepageManager'

export default {
  name: 'LearningModeSelector',
  mixins: [userPersonalizationMixin, permissionMixin],
  data() {
    return {
      selectedHomepage: '',
      userId: 'default',
      userSettings: new UserSettingsManager(),
      // å­¦ä¹ æ¨¡å¼æƒé™æ˜ å°„
      modePermissions: {
        'word-reading': 'practice_reading',
        'word-learning': 'view_word_learning',
        'word-detail': 'view_word_detail',
        'word-root-analysis': 'analyze_word_roots',
        'story-reading': 'practice_story_reading',
        'spelling': 'practice_spelling',
        'flashcard': 'use_flashcard',
        'pattern-memory': 'use_pattern_memory',
        'word-challenge': 'participate_challenge',
        'word-review': 'review_words',
        'word-selection': 'practice_word_selection',
        'teacher-student-interaction': 'practice_word_selection',
        'competition': 'participate_challenge',
        'quick-brush': 'review_words'
      }
    }
  },
  
  computed: {
    /**
     * æ ¹æ®ç”¨æˆ·æƒé™è¿‡æ»¤å¯ç”¨çš„å­¦ä¹ æ¨¡å¼
     */
    availableModes() {
      const allModes = Object.keys(this.modePermissions)
      return allModes.filter(mode => {
        const permission = this.modePermissions[mode]
        return this.$hasPermission(permission)
      })
    }
  },
  methods: {
    /**
     * æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æœ‰æƒé™ä½¿ç”¨æŒ‡å®šæ¨¡å¼
     */
    canUseMode(mode) {
      const permission = this.modePermissions[mode]
      if (!permission) {
        console.warn(`æœªå®šä¹‰æ¨¡å¼ ${mode} çš„æƒé™è¦æ±‚`)
        return false
      }
      return this.$hasPermission(permission)
    },
    
    /**
     * å¯¼èˆªåˆ°æŒ‡å®šæ¨¡å¼ï¼ˆå¸¦æƒé™æ£€æŸ¥ï¼‰
     */
    navigateToMode(mode) {
      if (!this.canUseMode(mode)) {
        this.$showError(`æ‚¨æ²¡æœ‰æƒé™ä½¿ç”¨${this.getModeName(mode)}åŠŸèƒ½`)
        return
      }
      
      // æ‰§è¡Œå¯¼èˆª
      switch(mode) {
        case 'word-reading':
          this.$router.push('/word-reading')
          break
        case 'word-learning':
          this.$router.push('/word-learning')
          break
        case 'word-detail':
          this.$router.push('/word-detail/institution')
          break
        case 'word-root-analysis':
          this.$router.push('/word-root-analysis')
          break
        case 'story-reading':
          this.$router.push('/story-reading')
          break
        case 'spelling':
          this.$router.push('/word-learning/spelling')
          break
        case 'flashcard':
          this.$router.push('/word-learning/flashcard')
          break
        case 'pattern-memory':
          this.$router.push('/pattern-memory')
          break
        case 'word-challenge':
          this.$router.push('/word-challenge')
          break
        case 'word-review':
          this.$router.push('/word-review')
          break
        case 'word-selection':
          this.$router.push('/word-selection')
          break
        case 'teacher-student-interaction':
          this.$router.push('/word-selection-practice2')
          break
        case 'competition':
          this.$router.push('/competition')
          break
        case 'quick-brush':
          this.$router.push('/quick-brush')
          break
        default:
          console.log('æœªçŸ¥æ¨¡å¼:', mode)
      }
    },
    
    setHomepage(mode) {
      if (!this.canUseMode(mode)) {
        this.$showError(`æ‚¨æ²¡æœ‰æƒé™å°†${this.getModeName(mode)}è®¾ç½®ä¸ºé¦–é¡µ`)
        return
      }
      
      const success = homepageManager.setHomepage(mode)
      if (success) {
        this.selectedHomepage = mode
        
        // åªæ˜¾ç¤ºè®¾ç½®æˆåŠŸæç¤ºï¼Œä¸è‡ªåŠ¨è·³è½¬
        this.$nextTick(() => {
          this.$showSuccess(`å·²å°†"${homepageManager.getModeName(mode)}"è®¾ç½®ä¸ºé¦–é¡µ`)
        })
      } else {
        this.$showError('è®¾ç½®é¦–é¡µå¤±è´¥ï¼Œè¯·é‡è¯•')
      }
    },
    
    clearHomepage() {
      const success = homepageManager.clearHomepage()
      if (success) {
        this.selectedHomepage = ''
      }
    },
    
    getModeName(mode) {
      return homepageManager.getModeName(mode)
    },
    
    // è·å–ç”¨æˆ·ID
    getUserId() {
      this.userId = this.userSettings.userId
    },
    
    // åŠ è½½ç”¨æˆ·çš„é¦–é¡µè®¾ç½®
    loadUserHomepageSettings() {
      this.selectedHomepage = homepageManager.getHomepage() || ''
    }
  },
  
  mounted() {
    // è·å–ç”¨æˆ·ID
    this.getUserId()
    
    // åŠ è½½ç”¨æˆ·çš„é¦–é¡µè®¾ç½®
    this.loadUserHomepageSettings()
    
    // åº”ç”¨ç«æŠ€æ¨¡å¼å…ƒç´ é…ç½®
    this.$nextTick(() => {
      const competitionConfigs = predefinedElementConfigs.competitionElements
      if (competitionConfigs && typeof competitionConfigs === 'object') {
        // competitionConfigs æ˜¯å¯¹è±¡ï¼Œä¸æ˜¯æ•°ç»„ï¼Œæ‰€ä»¥ä½¿ç”¨ Object.entries éå†
        Object.entries(competitionConfigs).forEach(([key, config]) => {
          if (config && config.position && config.size) {
            // åº”ç”¨å…ƒç´ é…ç½®
            console.log(`Applying config for ${key}:`, config)
          }
        })
      }
    })
    
    // æš‚æ—¶ç¦ç”¨è‡ªåŠ¨é‡å®šå‘åŠŸèƒ½
    // è¿™æ ·å¯ä»¥é¿å…ç™»å½•åç«‹å³è·³è½¬çš„é—®é¢˜
    console.log('LearningModeSelector: å·²ç¦ç”¨è‡ªåŠ¨é‡å®šå‘ï¼Œç”¨æˆ·å¯æ‰‹åŠ¨é€‰æ‹©å­¦ä¹ æ¨¡å¼')
  }
}
</script>