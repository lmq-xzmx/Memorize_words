<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>九宫格进度图表 - 演示页面</title>
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <!-- 自定义样式 -->
    <link href="{% load static %}{% static 'css/progress_chart.css' %}" rel="stylesheet">
    
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .demo-container {
            padding: 40px 0;
        }
        
        .demo-card {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            padding: 30px;
            margin-bottom: 30px;
        }
        
        .demo-title {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            font-weight: 700;
        }
        
        .control-panel {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
        }
        
        .btn-demo {
            margin: 5px;
            border-radius: 25px;
            padding: 8px 20px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .btn-demo:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        .code-example {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            overflow-x: auto;
            margin: 20px 0;
        }
        
        .theme-switcher {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }
        
        .message-area {
            min-height: 60px;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <!-- 主题切换器 -->
    <div class="theme-switcher">
        <button class="btn btn-outline-light btn-sm" onclick="toggleTheme()">
            <i class="fas fa-palette"></i> 切换主题
        </button>
    </div>
    
    <div class="container demo-container">
        <div class="row justify-content-center">
            <div class="col-lg-10">
                <!-- 标题 -->
                <h1 class="demo-title">
                    <i class="fas fa-chart-pie text-primary"></i>
                    九宫格进度图表演示
                </h1>
                
                <!-- 主要演示区域 -->
                <div class="demo-card">
                    <h3 class="text-center mb-4">实时数据展示</h3>
                    
                    <!-- 控制面板 -->
                    <div class="control-panel">
                        <div class="row align-items-center">
                            <div class="col-md-8">
                                <h5 class="mb-3"><i class="fas fa-cogs"></i> 控制面板</h5>
                                <button class="btn btn-primary btn-demo" onclick="loadSampleData()">
                                    <i class="fas fa-database"></i> 加载示例数据
                                </button>
                                <button class="btn btn-success btn-demo" onclick="loadRandomData()">
                                    <i class="fas fa-random"></i> 随机数据
                                </button>
                                <button class="btn btn-warning btn-demo" onclick="animateValues()">
                                    <i class="fas fa-play"></i> 动画演示
                                </button>
                                <button class="btn btn-info btn-demo" onclick="resetChart()">
                                    <i class="fas fa-refresh"></i> 重置
                                </button>
                            </div>
                            <div class="col-md-4 text-end">
                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" id="responsiveMode" checked>
                                    <label class="form-check-label" for="responsiveMode">
                                        响应式模式
                                    </label>
                                </div>
                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" id="animationMode" checked>
                                    <label class="form-check-label" for="animationMode">
                                        动画效果
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 图表容器 -->
                    <div id="demo-chart"></div>
                    
                    <!-- 消息区域 -->
                    <div id="message-area" class="message-area"></div>
                </div>
                
                <!-- 统计信息 -->
                <div class="demo-card">
                    <h3 class="text-center mb-4">数据统计</h3>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value" id="total-items">8</div>
                            <div class="stat-label">总项目数</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="total-value">64</div>
                            <div class="stat-label">总数值</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="max-value">49</div>
                            <div class="stat-label">最大值</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="avg-value">8</div>
                            <div class="stat-label">平均值</div>
                        </div>
                    </div>
                </div>
                
                <!-- 使用说明 -->
                <div class="demo-card">
                    <h3 class="text-center mb-4">使用说明</h3>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <h5><i class="fas fa-code"></i> 基础用法</h5>
                            <div class="code-example">
// 创建图表实例
const chart = new ProgressChart('chart-container', {
    title: '九宫格',
    subtitle: '进程',
    animated: true,
    responsive: true
});

// 更新数据
chart.updateData([
    { position: 1, label: '掌握', value: 49 },
    { position: 2, label: '遗忘', value: 0 },
    // ... 更多数据
]);
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <h5><i class="fas fa-cog"></i> 配置选项</h5>
                            <div class="code-example">
// 配置选项
const options = {
    title: '自定义标题',
    subtitle: '自定义副标题',
    theme: 'dark',
    clickable: true,
    showTooltip: true,
    onItemClick: (item) => {
        console.log('点击了:', item);
    }
};
                            </div>
                        </div>
                    </div>
                    
                    <div class="row mt-4">
                        <div class="col-12">
                            <h5><i class="fas fa-palette"></i> 自定义颜色</h5>
                            <div class="code-example">
// 自定义颜色方案
const customColors = {
    1: 'linear-gradient(135deg, #FF6B6B, #FF8E53)',
    2: 'linear-gradient(135deg, #4ECDC4, #44A08D)',
    3: 'linear-gradient(135deg, #45B7D1, #96C93D)',
    // ... 更多颜色
};

chart.updateOptions({ colors: customColors });
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Bootstrap 5 JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/bootstrap.bundle.min.js"></script>
    <!-- 图表组件 -->
    <script src="{% load static %}{% static 'js/progress_chart.js' %}"></script>
    
    <script>
        // 全局变量
        let demoChart;
        let currentTheme = 'light';
        
        // 示例数据
        const sampleData = [
            { position: 1, category: '掌握', label: '掌握', value: 49 },
            { position: 2, category: '遗忘', label: '遗忘', value: 0 },
            { position: 3, category: '学习中', label: '学习中', value: 15 },
            { position: 4, category: '测试', label: '测试', value: 0 },
            { position: 5, category: '口音文本', label: '口音文本', value: 0 },
            { position: 6, category: '口音文件', label: '口音文件', value: 0 },
            { position: 7, category: '区域化任务', label: '区域化任务', value: 0 },
            { position: 8, category: '解决方案', label: '解决方案', value: 0 }
        ];
        
        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', function() {
            initChart();
            loadSampleData();
        });
        
        // 初始化图表
        function initChart() {
            demoChart = new ProgressChart('demo-chart', {
                title: '九宫格',
                subtitle: '进程',
                animated: true,
                responsive: true,
                theme: currentTheme,
                onItemClick: handleItemClick,
                onItemHover: handleItemHover
            });
        }
        
        // 加载示例数据
        function loadSampleData() {
            demoChart.updateData(sampleData);
            updateStats(sampleData);
            showMessage('已加载示例数据', 'success');
        }
        
        // 生成随机数据
        function loadRandomData() {
            const randomData = sampleData.map(item => ({
                ...item,
                value: Math.floor(Math.random() * 100)
            }));
            
            demoChart.updateData(randomData);
            updateStats(randomData);
            showMessage('已生成随机数据', 'info');
        }
        
        // 动画演示
        function animateValues() {
            const steps = 20;
            let currentStep = 0;
            
            const interval = setInterval(() => {
                const animatedData = sampleData.map(item => ({
                    ...item,
                    value: Math.floor((item.value * currentStep) / steps)
                }));
                
                demoChart.updateData(animatedData);
                updateStats(animatedData);
                
                currentStep++;
                if (currentStep > steps) {
                    clearInterval(interval);
                    showMessage('动画演示完成', 'success');
                }
            }, 100);
            
            showMessage('正在播放动画...', 'info');
        }
        
        // 重置图表
        function resetChart() {
            const emptyData = sampleData.map(item => ({ ...item, value: 0 }));
            demoChart.updateData(emptyData);
            updateStats(emptyData);
            showMessage('图表已重置', 'warning');
        }
        
        // 切换主题
        function toggleTheme() {
            currentTheme = currentTheme === 'light' ? 'dark' : 'light';
            demoChart.updateOptions({ theme: currentTheme });
            showMessage(`已切换到${currentTheme === 'light' ? '浅色' : '深色'}主题`, 'info');
        }
        
        // 处理项目点击
        function handleItemClick(item, event) {
            showMessage(`点击了 "${item.label}": ${item.value}`, 'primary');
            console.log('Item clicked:', item);
        }
        
        // 处理项目悬停
        function handleItemHover(item, event) {
            console.log('Item hovered:', item);
        }
        
        // 更新统计信息
        function updateStats(data) {
            const totalItems = data.length;
            const totalValue = data.reduce((sum, item) => sum + item.value, 0);
            const maxValue = Math.max(...data.map(item => item.value));
            const avgValue = Math.round(totalValue / totalItems);
            
            document.getElementById('total-items').textContent = totalItems;
            document.getElementById('total-value').textContent = totalValue;
            document.getElementById('max-value').textContent = maxValue;
            document.getElementById('avg-value').textContent = avgValue;
        }
        
        // 显示消息
        function showMessage(message, type = 'info') {
            const messageArea = document.getElementById('message-area');
            const alertClass = {
                'success': 'alert-success',
                'info': 'alert-info',
                'warning': 'alert-warning',
                'danger': 'alert-danger',
                'primary': 'alert-primary'
            }[type] || 'alert-info';
            
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert ${alertClass} alert-dismissible fade show`;
            alertDiv.innerHTML = `
                <i class="fas fa-info-circle"></i> ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            
            messageArea.appendChild(alertDiv);
            
            // 3秒后自动消失
            setTimeout(() => {
                if (alertDiv.parentNode) {
                    alertDiv.remove();
                }
            }, 3000);
        }
        
        // 监听配置变化
        document.getElementById('responsiveMode').addEventListener('change', function(e) {
            demoChart.updateOptions({ responsive: e.target.checked });
            showMessage(`响应式模式已${e.target.checked ? '开启' : '关闭'}`, 'info');
        });
        
        document.getElementById('animationMode').addEventListener('change', function(e) {
            demoChart.updateOptions({ animated: e.target.checked });
            showMessage(`动画效果已${e.target.checked ? '开启' : '关闭'}`, 'info');
        });
    </script>
</body>
</html>