{% extends "admin/change_list.html" %}
{% load i18n admin_urls static admin_list %}

{% block content_title %}
    <h1>{{ title }}</h1>
    
    <!-- 角色快速筛选 -->
    <div class="role-filter-bar">
        <h3>📊 按角色筛选用户</h3>
        <div class="role-buttons">
            <!-- 全部用户 -->
            <a href="?" class="role-filter-btn {% if not current_role_filter %}active{% endif %}">
                🏠 全部用户
            </a>
            
            <!-- 各角色筛选按钮 -->
            {% for role_value, role_info in role_stats.items %}
                <a href="?role={{ role_value }}" class="role-filter-btn {% if current_role_filter == role_value %}active{% endif %}">
                    {% if role_value == 'admin' %}👨‍💼{% elif role_value == 'teacher' %}👩‍🏫{% elif role_value == 'student' %}👨‍🎓{% elif role_value == 'parent' %}👨‍👩‍👧‍👦{% endif %}
                    {{ role_info.label }} ({{ role_info.count }})
                </a>
            {% endfor %}
        </div>
        
        {% if current_role_filter %}
            <div class="current-filter">
                <span class="filter-tag">
                    当前筛选: {{ current_role_filter }}
                </span>
                <a href="?" class="clear-filter">✖ 清除筛选</a>
            </div>
        {% endif %}
    </div>
{% endblock %}

{% block extrahead %}
    {{ block.super }}
    <style>
        .role-filter-bar {
            margin: 15px 0;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 5px;
            border: 1px solid #dee2e6;
        }
        
        .role-filter-bar h3 {
            margin: 0 0 10px 0;
            font-size: 14px;
            color: #495057;
        }
        
        .role-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        
        .role-filter-btn {
            padding: 6px 12px;
            text-decoration: none;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
            background: white;
            color: #007cba;
            border: 1px solid #007cba;
        }
        
        .role-filter-btn.active {
            background: #007cba;
            color: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .role-filter-btn:hover {
             opacity: 0.8;
             transform: translateY(-1px);
             transition: all 0.2s ease;
         }
         
         .current-filter {
             margin-top: 8px;
             font-size: 12px;
             color: #6c757d;
         }
         
         .filter-tag {
             background: #e7f3ff;
             padding: 2px 6px;
             border-radius: 3px;
         }
         
         .clear-filter {
             margin-left: 8px;
             color: #dc3545;
             text-decoration: none;
         }
         
         @media (max-width: 768px) {
             .role-buttons {
                 flex-direction: column;
             }
             
             .role-filter-btn {
                 text-align: center;
             }
         }
    </style>
{% endblock %}