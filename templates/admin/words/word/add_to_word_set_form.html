{% extends "admin/base_site.html" %}
{% load i18n %}

{% block content %}
<div id="content-main">
  <form action="{% url 'admin:words_word_changelist' %}" method="post">
    {% csrf_token %}
    <input type="hidden" name="action" value="add_to_word_set" />
    <input type="hidden" name="index" value="0" />
    
    <h2>{% trans '将选中的单词添加到单词集' %}</h2>
    <p>{% blocktrans count counter=queryset.count %}您选择了 {{ counter }} 个单词。{% plural %}您选择了 {{ counter }} 个单词。{% endblocktrans %}</p>

    {% for obj in queryset %}
    <input type="hidden" name="{{ action_checkbox_name }}" value="{{ obj.pk }}" />
    {% endfor %}
    
    <fieldset class="module aligned">
      <div class="form-row">
        <label for="word_set">{% trans '选择一个现有的单词集:' %}</label>
        <select name="word_set" id="word_set">
          <option value="">---------</option>
          {% for ws in word_sets %}
          <option value="{{ ws.pk }}">{{ ws.name }}</option>
          {% endfor %}
        </select>
      </div>
    </fieldset>
    
    <fieldset class="module aligned">
        <h2>{% trans '或者' %}</h2>
        <div class="form-row">
            <input type="checkbox" name="create_new_wordset" id="create_new_wordset" style="margin-left: 120px;">
            <label for="create_new_wordset">{% trans '创建一个新的单词集' %}</label>
        </div>
        <div class="form-row" id="new_wordset_name_row" style="display: none;">
            <label for="new_wordset_name">{% trans '新单词集名称:' %}</label>
            <input type="text" name="new_wordset_name" id="new_wordset_name" />
        </div>
    </fieldset>

    <div>
      <input type="submit" name="apply" value="{% trans '确认添加' %}" class="default" />
      <a href="#" onclick="window.history.back(); return false;" class="button cancel-link">{% trans '取消' %}</a>
    </div>
  </form>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const createNewCheckbox = document.getElementById('create_new_wordset');
    const newWordsetNameRow = document.getElementById('new_wordset_name_row');
    const wordSetSelect = document.getElementById('word_set');

    createNewCheckbox.addEventListener('change', function() {
        if (this.checked) {
            newWordsetNameRow.style.display = 'flex';
            wordSetSelect.disabled = true;
            wordSetSelect.value = '';
        } else {
            newWordsetNameRow.style.display = 'none';
            wordSetSelect.disabled = false;
        }
    });
});
</script>
{% endblock %}